<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>الدليل المحسّن لـ Excel - 35+ موضوعًا تفاعليًا</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --excel-green: #217346;
            --excel-dark-green: #185b37;
            --excel-light-green: #e6f2ed;
            --text-dark: #2c3e50;
            --text-light: #f8f9f9;
            --accent: #e67e22;
            --success: #28b463;
            --warning: #f39c12;
            --danger: #e74c3c;
            --info: #3498db;
            --border-radius: 8px;
            --box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Tahoma', 'Geneva', 'Verdana', sans-serif;
            line-height: 1.7;
            color: var(--text-dark);
            background-color: #f8fafc;
            overflow-x: hidden;
        }

        .container {
            width: 100%;
            max-width: 1300px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header Styles */
        header {
            background: linear-gradient(135deg, var(--excel-green), var(--excel-dark-green));
            color: white;
            padding: 2.5rem 1rem;
            text-align: center;
            margin-bottom: 2.5rem;
            position: relative;
            overflow: hidden;
            box-shadow: var(--box-shadow);
        }

        header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none"><rect fill="rgba(255,255,255,0.1)" width="12" height="12" x="0" y="0"></rect></svg>');
            opacity: 0.2;
        }

        h1 {
            font-size: clamp(2rem, 5vw, 2.8rem);
            margin-bottom: 0.8rem;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .header-description {
            font-size: clamp(1rem, 2.5vw, 1.2rem);
            max-width: 800px;
            margin: 0 auto 1.5rem;
            opacity: 0.9;
            line-height: 1.6;
        }

        .developer-badge {
            background-color: rgba(255, 255, 255, 0.15);
            display: inline-flex;
            align-items: center;
            padding: 0.6rem 1.5rem;
            border-radius: 50px;
            margin-top: 1rem;
            font-size: 0.95rem;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            gap: 0.8rem;
        }

        /* Navigation Tabs */
        .tabs-container {
            position: sticky;
            top: 0;
            background: white;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 2.5rem;
        }

        .tabs-scroll {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
            padding-bottom: 5px;
        }

        .tabs-scroll::-webkit-scrollbar {
            display: none;
        }

        .tabs {
            display: inline-flex;
            background: white;
            padding: 0.8rem;
            border-radius: 50px;
            min-width: min-content;
        }

        .tab {
            padding: 0.8rem 1.8rem;
            background: var(--excel-light-green);
            border-radius: 50px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
            color: var(--text-dark);
            margin: 0 0.3rem;
            white-space: nowrap;
            font-size: 0.95rem;
            border: 2px solid transparent;
            display: flex;
            align-items: center;
            gap: 0.7rem;
        }

        .tab:hover {
            background: var(--accent);
            color: white;
            transform: translateY(-2px);
        }

        .tab.active {
            background: var(--excel-green);
            color: white;
            border-color: white;
            box-shadow: 0 5px 15px rgba(33, 115, 70, 0.3);
        }

        .tab i {
            font-size: 1.1rem;
        }

        /* Main Content */
        .category {
            margin-bottom: 4rem;
            animation: fadeIn 0.6s ease-out;
        }

        .category-title {
            color: var(--excel-green);
            font-size: clamp(1.6rem, 3vw, 2rem);
            margin-bottom: 2rem;
            padding-bottom: 0.8rem;
            border-bottom: 3px solid var(--accent);
            position: relative;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .category-title::after {
            content: "";
            position: absolute;
            bottom: -3px;
            right: 0;
            width: 120px;
            height: 3px;
            background: var(--excel-green);
        }

        .topics-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 2rem;
        }

        /* Topic Cards */
        .topic {
            background: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
            border: 1px solid #e2e8f0;
        }

        .topic:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }

        .topic-header {
            background: var(--excel-green);
            color: white;
            padding: 1.2rem;
            font-weight: 700;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        .topic-header i {
            font-size: 1.2rem;
        }

        .topic-content {
            padding: 1.8rem;
        }

        .topic h3 {
            color: var(--excel-dark-green);
            margin-bottom: 1.2rem;
            font-size: 1.15rem;
            font-weight: 600;
            line-height: 1.5;
        }

        .topic p {
            margin-bottom: 1.5rem;
            color: var(--text-dark);
            line-height: 1.7;
        }

        /* Examples and Exercises */
        .example, .exercise {
            background: var(--excel-light-green);
            padding: 1.5rem;
            border-radius: var(--border-radius);
            margin: 1.5rem 0;
            position: relative;
            border-left: 4px solid var(--excel-green);
        }

        .example::before, .exercise::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            background: var(--excel-green);
            color: white;
            padding: 0.4rem 1.2rem;
            font-size: 0.85rem;
            font-weight: 700;
            border-bottom-right-radius: var(--border-radius);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .example::before {
            content: "مثال عملي";
        }

        .exercise::before {
            content: "تمرين تطبيقي";
            background: var(--info);
        }

        .example ol, .exercise ol,
        .example ul, .exercise ul {
            margin-right: 1.2rem;
            margin-bottom: 1rem;
        }

        .example li, .exercise li {
            margin-bottom: 0.8rem;
            position: relative;
            padding-right: 1.5rem;
        }

        .example li::before, .exercise li::before {
            content: "•";
            color: var(--accent);
            font-weight: bold;
            position: absolute;
            right: 0;
            font-size: 1.2rem;
        }

        /* Formulas */
        .formula-container {
            direction: ltr;
            text-align: left;
            margin: 1.2rem 0;
            overflow-x: auto;
            padding-bottom: 5px;
        }

        .formula {
            font-family: 'Courier New', Courier, monospace;
            background: var(--text-dark);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: var(--border-radius);
            display: inline-block;
            margin: 0.5rem 0;
            font-size: 1.05rem;
            box-shadow: var(--box-shadow);
            border-left: 4px solid var(--accent);
            white-space: nowrap;
            font-weight: 500;
        }

        /* Buttons */
        .btn {
            background: var(--excel-green);
            color: white;
            border: none;
            padding: 0.9rem 1.6rem;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
            margin-top: 1rem;
            display: inline-flex;
            align-items: center;
            gap: 0.8rem;
            font-size: 0.95rem;
            box-shadow: 0 4px 8px rgba(33, 115, 70, 0.2);
        }

        .btn:hover {
            background: var(--excel-dark-green);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(33, 115, 70, 0.3);
        }

        .btn i {
            font-size: 1rem;
        }

        .btn-secondary {
            background: white;
            color: var(--excel-green);
            border: 2px solid var(--excel-green);
        }

        .btn-secondary:hover {
            background: var(--excel-light-green);
        }

        /* Interactive Excel Grid */
        .interactive-excel {
            width: 100%;
            border: 1px solid #e2e8f0;
            margin: 1.8rem 0;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--box-shadow);
        }

        .excel-toolbar {
            background: #f8fafc;
            padding: 1rem;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            gap: 0.8rem;
            flex-wrap: wrap;
        }

        /* Excel Table Styles */
        .excel-container {
            width: 100%;
            overflow-x: auto;
            margin: 1.5rem 0;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            background: white;
            border: 1px solid #e2e8f0;
        }

        .excel-table {
            border-collapse: collapse;
            width: 100%;
            direction: ltr;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .excel-table th, .excel-table td {
            border: 1px solid #e2e8f0;
            padding: 0.8rem;
            min-width: 90px;
            text-align: center;
            vertical-align: middle;
        }

        .excel-table th {
            background: var(--excel-green);
            color: white;
            font-weight: 600;
            position: sticky;
            top: 0;
        }

        .excel-table td {
            background: white;
            text-align: left;
        }

        .excel-table td.formula {
            background: #f0f7ff;
            color: #1a5276;
            font-family: 'Courier New', Courier, monospace;
            font-weight: 500;
        }

        .excel-table td.result {
            background: #e8f8f5;
            color: #1d8348;
            font-weight: 500;
        }

        .excel-table td[contenteditable="true"]:focus {
            outline: 2px solid var(--accent);
            z-index: 1;
            position: relative;
        }

        .excel-row-header {
            background: var(--excel-green);
            color: white;
            font-weight: 600;
        }

        /* Solution Box */
        .solution {
            display: none;
            margin-top: 1.5rem;
            padding: 1.5rem;
            background: #f8fafc;
            border-radius: var(--border-radius);
            border-left: 4px solid var(--info);
            animation: fadeIn 0.5s ease-out;
        }

        .solution-title {
            font-weight: 700;
            color: var(--info);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            font-size: 1.1rem;
        }

        .solution-title i {
            font-size: 1.2rem;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Floating Action Button */
        .fab {
            position: fixed;
            bottom: 2rem;
            left: 2rem;
            background: var(--excel-green);
            color: white;
            width: 3.5rem;
            height: 3.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            z-index: 100;
            transition: var(--transition);
            opacity: 0;
            visibility: hidden;
            transform: translateY(20px);
        }

        .fab.visible {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .fab:hover {
            background: var(--excel-dark-green);
            transform: translateY(-3px) scale(1.05);
        }

        /* Progress Indicator */
        .progress-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: transparent;
            z-index: 1000;
        }

        .progress-bar {
            height: 100%;
            background: var(--excel-green);
            width: 0%;
            transition: width 0.1s ease;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .topics-container {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                gap: 1.5rem;
            }
            
            .excel-table th, .excel-table td {
                min-width: 80px;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 0 15px;
            }
            
            header {
                padding: 2rem 1rem;
            }
            
            .tabs {
                padding: 0.6rem;
            }
            
            .tab {
                padding: 0.6rem 1.2rem;
                font-size: 0.9rem;
            }
            
            .topic-content {
                padding: 1.5rem;
            }
            
            .excel-table th, .excel-table td {
                min-width: 70px;
                padding: 0.6rem;
                font-size: 0.9rem;
            }
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 1.8rem;
            }
            
            .header-description {
                font-size: 0.95rem;
            }
            
            .developer-badge {
                font-size: 0.85rem;
                padding: 0.5rem 1.2rem;
            }
            
            .topics-container {
                grid-template-columns: 1fr;
            }
            
            .category-title {
                font-size: 1.4rem;
            }
            
            .excel-table th, .excel-table td {
                min-width: 60px;
                font-size: 0.85rem;
                padding: 0.5rem;
            }
            
            .btn {
                padding: 0.8rem 1.2rem;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <!-- Progress Bar -->
    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>

    <div class="container">
        <header>
            <h1>الدليل المحسّن لبرنامج Excel</h1>
            <p class="header-description">اساسيات في الاكسل</p>
            <div class="developer-badge">
                <i class="fas fa-code"></i> م/مطيع داؤود المحجري
            </div>
        </header>

        <!-- Navigation Tabs -->
        <div class="tabs-container">
            <div class="tabs-scroll">
                <div class="tabs">
                    <div class="tab active" data-category="basics">
                        <i class="fas fa-bolt"></i> الأساسيات
                    </div>
                    <div class="tab" data-category="formulas">
                        <i class="fas fa-square-root-alt"></i> الصيغ
                    </div>
                    <div class="tab" data-category="functions">
                        <i class="fas fa-function"></i> الدوال
                    </div>
                    <div class="tab" data-category="data-analysis">
                        <i class="fas fa-chart-bar"></i> تحليل البيانات
                    </div>
                    <div class="tab" data-category="advanced">
                        <i class="fas fa-cogs"></i> متقدم
                    </div>
                </div>
            </div>
        </div>

        <!-- الأساسيات -->
        <div class="category" id="basics">
            <h2 class="category-title">
                <i class="fas fa-bolt"></i> أساسيات Excel
            </h2>
            
            <div class="topics-container">
                <!-- الموضوع 1 -->
                <div class="topic">
                    <div class="topic-header">
                        <i class="fas fa-desktop"></i> واجهة البرنامج
                    </div>
                    <div class="topic-content">
                        <h3>التعرف على واجهة Excel الرئيسية</h3>
                        <p>شرح شامل لمكونات واجهة المستخدم في Excel وكيفية التنقل بينها.</p>
                        
                        <div class="example">
                            <p>المكونات الرئيسية:</p>
                            <ul>
                                <li>شريط القوائم (Ribbon) - يحتوي على جميع الأوامر</li>
                                <li>شريط الصيغ - لعرض وتحرير محتوى الخلايا</li>
                                <li>شريط الأدوات السريع - للوصول السريع للأوامر</li>
                                <li>أوراق العمل - حيث يتم إدخال البيانات</li>
                            </ul>
                        </div>
                        
                        <div class="exercise">
                            <p>التمرين العملي:</p>
                            <ol>
                                <li>افتح ملف Excel جديد</li>
                                <li>جرب التنقل بين علامات التبويب في الشريط</li>
                                <li>قم بتغيير اسم الورقة الحالية</li>
                                <li>أضف ورقة جديدة</li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- الموضوع 2 -->
                <div class="topic">
                    <div class="topic-header">
                        <i class="fas fa-keyboard"></i> إدخال البيانات
                    </div>
                    <div class="topic-content">
                        <h3>طرق إدخال البيانات وتنسيقها</h3>
                        <p>كيفية إدخال مختلف أنواع البيانات في الخلايا وتنسيقها بشكل صحيح.</p>
                        
                        <div class="example">
                            <p>أنواع البيانات:</p>
                            <ul>
                                <li>النصوص: أدخل أي نص عادي</li>
                                <li>الأرقام: يمكن إدخالها مباشرة</li>
                                <li>التواريخ: استخدم صيغة التاريخ الصحيحة</li>
                                <li>الصيغ: تبدأ بعلامة =</li>
                            </ul>
                        </div>
                        
                        <div class="interactive-excel">
                            <div class="excel-toolbar">
                                <button class="btn" onclick="fillSampleData('dataEntryTable')">
                                    <i class="fas fa-magic"></i> بيانات نموذجية
                                </button>
                                <button class="btn btn-secondary" onclick="resetTable('dataEntryTable')">
                                    <i class="fas fa-redo"></i> إعادة تعيين
                                </button>
                            </div>
                            <div class="excel-container">
                                <table class="excel-table" id="dataEntryTable"></table>
                            </div>
                        </div>
                        
                        <button class="btn" onclick="toggleSolution('solution1')">
                            <i class="fas fa-lightbulb"></i> عرض نصائح الإدخال
                        </button>
                        
                        <div id="solution1" class="solution">
                            <div class="solution-title">
                                <i class="fas fa-check-circle"></i> نصائح مهمة:
                            </div>
                            <ul>
                                <li>للانتقال بين الخلايا استخدم مفاتيح الأسهم</li>
                                <li>اضغط Enter لإنهاء إدخال البيانات في الخلية</li>
                                <li>استخدم F2 لتحرير محتوى الخلية الحالية</li>
                                <li>لإدخال التاريخ الحالي اضغط Ctrl+;</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- الموضوع 3 -->
                <div class="topic">
                    <div class="topic-header">
                        <i class="fas fa-paint-brush"></i> التنسيق الأساسي
                    </div>
                    <div class="topic-content">
                        <h3>تنسيق الخلايا والبيانات</h3>
                        <p>كيفية تغيير مظهر الخلايا والبيانات لتحسين القراءة والعرض.</p>
                        
                        <div class="example">
                            <p>خيارات التنسيق الأساسية:</p>
                            <ul>
                                <li>تنسيق الخط: حجم، لون، غامق، مائل</li>
                                <li>تنسيق الخلية: لون الخلفية، الحدود</li>
                                <li>محاذاة النص: أفقية، رأسية، دمج خلايا</li>
                                <li>تنسيق الأرقام: عملة، تاريخ، نسب مئوية</li>
                            </ul>
                        </div>
                        
                        <div class="interactive-excel">
                            <div class="excel-toolbar">
                                <button class="btn" onclick="fillFormattingSample()">
                                    <i class="fas fa-magic"></i> بيانات نموذجية
                                </button>
                            </div>
                            <div class="excel-container">
                                <table class="excel-table" id="formattingTable"></table>
                            </div>
                        </div>
                        
                        <div class="exercise">
                            <p>التمرين العملي:</p>
                            <ol>
                                <li>قم بتطبيق تنسيق غامق على العناوين</li>
                                <li>غير لون خلفية الصفوف الزوجية</li>
                                <li>طبق تنسيق عملة على عمود السعر</li>
                                <li>قم بمحاذاة العناوين إلى الوسط</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- الصيغ -->
        <div class="category" id="formulas" style="display: none;">
            <h2 class="category-title">
                <i class="fas fa-square-root-alt"></i> الصيغ في Excel
            </h2>
            
            <div class="topics-container">
                <!-- الموضوع 1 -->
                <div class="topic">
                    <div class="topic-header">
                        <i class="fas fa-equals"></i> أساسيات الصيغ
                    </div>
                    <div class="topic-content">
                        <h3>بناء الصيغ واستخدام المراجع</h3>
                        <p>كيفية إنشاء صيغ أساسية في Excel باستخدام العوامل الحسابية والمراجع.</p>
                        
                        <div class="example">
                            <p>أنواع العوامل:</p>
                            <ul>
                                <li>الحسابية: +, -, *, /, ^</li>
                                <li>المقارنة: =, >, <, >=, <=, <></li>
                                <li>النصية: & (للدمج)</li>
                            </ul>
                        </div>
                        
                        <div class="formula-container">
                            <div class="formula">=A1+B1</div>
                            <div class="formula">=B2*10%</div>
                            <div class="formula">=C3&D3</div>
                        </div>
                        
                        <div class="exercise">
                            <p>التمرين العملي:</p>
                            <ol>
                                <li>أنشئ صيغة لجمع خليتين</li>
                                <li>أنشئ صيغة لضرب قيمة بخمسة</li>
                                <li>دمج نص من خليتين مع إضافة مسافة بينهما</li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- الموضوع 2 -->
                <div class="topic">
                    <div class="topic-header">
                        <i class="fas fa-anchor"></i> المراجع المطلقة والنسبية
                    </div>
                    <div class="topic-content">
                        <h3>الفرق بين المراجع النسبية والمطلقة</h3>
                        <p>كيفية استخدام علامة $ لتثبيت مراجع الصفوف أو الأعمدة عند نسخ الصيغ.</p>
                        
                        <div class="example">
                            <p>أنواع المراجع:</p>
                            <ul>
                                <li>نسبي (A1): يتغير عند النسخ</li>
                                <li>مطلق ($A$1): يبقى ثابتًا</li>
                                <li>مختلط (A$1 أو $A1): يثبت جزء فقط</li>
                            </ul>
                        </div>
                        
                        <div class="interactive-excel">
                            <div class="excel-toolbar">
                                <button class="btn" onclick="fillReferenceSample()">
                                    <i class="fas fa-magic"></i> مثال عملي
                                </button>
                            </div>
                            <div class="excel-container">
                                <table class="excel-table" id="referenceTable"></table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- الدوال -->
        <div class="category" id="functions" style="display: none;">
            <h2 class="category-title">
                <i class="fas fa-function"></i> دوال Excel
            </h2>
            
            <div class="topics-container">
                <!-- الموضوع 1 -->
                <div class="topic">
                    <div class="topic-header">
                        <i class="fas fa-calculator"></i> الدوال الرياضية
                    </div>
                    <div class="topic-content">
                        <h3>الدوال الأساسية: SUM, AVERAGE, MAX, MIN</h3>
                        <p>كيفية استخدام الدوال الرياضية الأساسية لإجراء عمليات حسابية على نطاقات من البيانات.</p>
                        
                        <div class="formula-container">
                            <div class="formula">=SUM(A1:A10)</div>
                            <div class="formula">=AVERAGE(B2:B20)</div>
                            <div class="formula">=MAX(C1:C100)</div>
                            <div class="formula">=MIN(D5:D15)</div>
                        </div>
                        
                        <div class="exercise">
                            <p>التمرين العملي:</p>
                            <ol>
                                <li>احسب مجموع عمود من الأرقام</li>
                                <li>احسب متوسط درجات الطلاب</li>
                                <li>حدد أعلى وأقل قيمة في نطاق</li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- الموضوع 2 -->
                <div class="topic">
                    <div class="topic-header">
                        <i class="fas fa-search"></i> دوال البحث
                    </div>
                    <div class="topic-content">
                        <h3>VLOOKUP و HLOOKUP</h3>
                        <p>كيفية استخدام دوال البحث للعثور على بيانات في جداول كبيرة.</p>
                        
                        <div class="formula-container">
                            <div class="formula">=VLOOKUP(value, table, col_index, [range_lookup])</div>
                            <div class="formula">=HLOOKUP(value, table, row_index, [range_lookup])</div>
                        </div>
                        
                        <div class="interactive-excel">
                            <div class="excel-toolbar">
                                <button class="btn" onclick="fillVlookupSample()">
                                    <i class="fas fa-magic"></i> مثال VLOOKUP
                                </button>
                            </div>
                            <div class="excel-container">
                                <table class="excel-table" id="vlookupTable"></table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- تحليل البيانات -->
        <div class="category" id="data-analysis" style="display: none;">
            <h2 class="category-title">
                <i class="fas fa-chart-bar"></i> تحليل البيانات
            </h2>
            
            <div class="topics-container">
                <!-- الموضوع 1 -->
                <div class="topic">
                    <div class="topic-header">
                        <i class="fas fa-filter"></i> الفرز والتصفية
                    </div>
                    <div class="topic-content">
                        <h3>كيفية فرز وتصفية البيانات</h3>
                        <p>استخدام أدوات الفرز والتصفية لتنظيم وعرض البيانات المطلوبة فقط.</p>
                        
                        <div class="example">
                            <p>خيارات الفرز:</p>
                            <ul>
                                <li>فرز من الألف إلى الياء</li>
                                <li>فرز من الأكبر إلى الأصغر</li>
                                <li>فرز مخصص حسب قائمة</li>
                                <li>فرز حسب لون الخلية أو الخط</li>
                            </ul>
                        </div>
                        
                        <div class="interactive-excel">
                            <div class="excel-toolbar">
                                <button class="btn" onclick="fillSortingSample()">
                                    <i class="fas fa-magic"></i> بيانات للفرز
                                </button>
                            </div>
                            <div class="excel-container">
                                <table class="excel-table" id="sortingTable"></table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- الموضوع 2 -->
                <div class="topic">
                    <div class="topic-header">
                        <i class="fas fa-chart-pie"></i> المخططات البيانية
                    </div>
                    <div class="topic-content">
                        <h3>إنشاء وتخصيص المخططات</h3>
                        <p>كيفية تمثيل البيانات بيانيًا باستخدام مختلف أنواع المخططات.</p>
                        
                        <div class="example">
                            <p>أنواع المخططات الشائعة:</p>
                            <ul>
                                <li>مخطط الأعمدة (Column)</li>
                                <li>مخطط الخطوط (Line)</li>
                                <li>مخطط الدائرة (Pie)</li>
                                <li>مخطط الشموع (Candlestick)</li>
                            </ul>
                        </div>
                        
                        <div class="exercise">
                            <p>التمرين العملي:</p>
                            <ol>
                                <li>أنشئ مخطط أعمدة لبيانات المبيعات</li>
                                <li>أضف عناوين للمحاور</li>
                                <li>غير ألوان المخطط</li>
                                <li>أضف تسميات البيانات</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- المتقدم -->
        <div class="category" id="advanced" style="display: none;">
            <h2 class="category-title">
                <i class="fas fa-cogs"></i> تقنيات متقدمة
            </h2>
            
            <div class="topics-container">
                <!-- الموضوع 1 -->
                <div class="topic">
                    <div class="topic-header">
                        <i class="fas fa-table"></i> الجداول المحورية
                    </div>
                    <div class="topic-content">
                        <h3>إنشاء وتخصيص الجداول المحورية</h3>
                        <p>كيفية استخدام الجداول المحورية لتلخيص وتحليل كميات كبيرة من البيانات.</p>
                        
                        <div class="example">
                            <p>مكونات الجدول المحوري:</p>
                            <ul>
                                <li>الحقول: الأعمدة في البيانات الأصلية</li>
                                <li>منطقة الصفوف</li>
                                <li>منطقة الأعمدة</li>
                                <li>منطقة القيم</li>
                                <li>منطقة عوامل التصفية</li>
                            </ul>
                        </div>
                        
                        <div class="exercise">
                            <p>التمرين العملي:</p>
                            <ol>
                                <li>أنشئ جدولاً محورياً من بيانات المبيعات</li>
                                <li>أضف حقولاً إلى مناطق مختلفة</li>
                                <li>طبق عوامل تصفية</li>
                                <li>عدل تنسيق الأرقام</li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- الموضوع 2 -->
                <div class="topic">
                    <div class="topic-header">
                        <i class="fas fa-code"></i> وحدات الماكرو
                    </div>
                    <div class="topic-content">
                        <h3>تسجيل وتشغيل وحدات الماكرو</h3>
                        <p>كيفية أتمتة المهام المتكررة باستخدام وحدات الماكرو.</p>
                        
                        <div class="example">
                            <p>استخدامات الماكرو:</p>
                            <ul>
                                <li>أتمتة عمليات التنسيق</li>
                                <li>إنشاء تقارير تلقائية</li>
                                <li>دمج بيانات من ملفات متعددة</li>
                                <li>إنشاء أزرار مخصصة</li>
                            </ul>
                        </div>
                        
                        <button class="btn" onclick="toggleSolution('macroSolution')">
                            <i class="fas fa-lightbulb"></i> مثال على ماكرو
                        </button>
                        
                        <div id="macroSolution" class="solution">
                            <div class="solution-title">
                                <i class="fas fa-code"></i> ماكرو لتنسيق الجدول:
                            </div>
                            <div class="formula-container">
                                <div class="formula">
                                    Sub FormatTable()<br>
                                    &nbsp;&nbsp;Range("A1:D1").Font.Bold = True<br>
                                    &nbsp;&nbsp;Range("A1:D1").Interior.Color = RGB(33, 115, 70)<br>
                                    &nbsp;&nbsp;Range("A1:D1").Font.Color = RGB(255, 255, 255)<br>
                                    &nbsp;&nbsp;Range("A2:D100").Borders.LineStyle = xlContinuous<br>
                                    End Sub
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Action Button -->
    <div class="fab" id="fabButton">
        <i class="fas fa-arrow-up"></i>
    </div>

    <script>
        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize all tables
            initTable('dataEntryTable', 6, 5);
            initTable('formattingTable', 5, 4);
            initTable('referenceTable', 5, 4);
            initTable('vlookupTable', 6, 4);
            initTable('sortingTable', 6, 4);
            
            // Tab switching functionality
            setupTabs();
            
            // Scroll progress indicator
            setupProgressBar();
            
            // Floating button functionality
            setupFloatingButton();
        });
        
        // Initialize a table with headers
        function initTable(tableId, rows, cols) {
            const table = document.getElementById(tableId);
            table.innerHTML = '';
            
            // Create header row
            const thead = document.createElement('thead');
            const headerRow = document.createElement('tr');
            
            // Add empty cell for row headers
            headerRow.appendChild(document.createElement('th'));
            
            // Create column headers
            for (let c = 0; c < cols; c++) {
                const th = document.createElement('th');
                th.textContent = String.fromCharCode(65 + c);
                headerRow.appendChild(th);
            }
            
            thead.appendChild(headerRow);
            table.appendChild(thead);
            
            // Create data rows
            const tbody = document.createElement('tbody');
            
            for (let r = 1; r <= rows; r++) {
                const tr = document.createElement('tr');
                
                // Row number
                const rowHeader = document.createElement('td');
                rowHeader.textContent = r;
                rowHeader.className = 'excel-row-header';
                tr.appendChild(rowHeader);
                
                // Data cells
                for (let c = 1; c <= cols; c++) {
                    const td = document.createElement('td');
                    td.contentEditable = 'true';
                    tr.appendChild(td);
                }
                
                tbody.appendChild(tr);
            }
            
            table.appendChild(tbody);
        }
        
        // Fill sample data for data entry table
        function fillSampleData(tableId) {
            const table = document.getElementById(tableId);
            const rows = table.querySelectorAll('tbody tr');
            
            // Sample data
            const sampleData = [
                ['المنتج', 'الفئة', 'السعر', 'الكمية', 'الإجمالي'],
                ['حاسوب محمول', 'إلكترونيات', '2500', '3', '=C2*D2'],
                ['هاتف ذكي', 'إلكترونيات', '1800', '5', '=C3*D3'],
                ['طابعة', 'أجهزة مكتب', '800', '2', '=C4*D4'],
                ['كرسي مكتب', 'أثاث', '600', '4', '=C5*D5'],
                ['مكتب', 'أثاث', '1200', '1', '=C6*D6']
            ];
            
            // Fill the table
            rows.forEach((row, rowIndex) => {
                const cells = row.querySelectorAll('td:not(.excel-row-header)');
                cells.forEach((cell, cellIndex) => {
                    if (sampleData[rowIndex] && sampleData[rowIndex][cellIndex]) {
                        cell.textContent = sampleData[rowIndex][cellIndex];
                        if (sampleData[rowIndex][cellIndex].startsWith('=')) {
                            cell.classList.add('formula');
                        } else {
                            cell.classList.remove('formula');
                        }
                    }
                });
            });
        }
        
        // Fill formatting sample data
        function fillFormattingSample() {
            const table = document.getElementById('formattingTable');
            const rows = table.querySelectorAll('tbody tr');
            
            // Sample data
            const sampleData = [
                ['الموظف', 'القسم', 'الراتب', 'تاريخ التعيين'],
                ['أحمد محمد', 'المبيعات', '5000', '15/03/2020'],
                ['سارة علي', 'التسويق', '4500', '22/07/2019'],
                ['محمد خالد', 'التطوير', '6000', '05/01/2021'],
                ['فاطمة عبدالله', 'الدعم الفني', '4000', '18/11/2020']
            ];
            
            // Fill the table
            rows.forEach((row, rowIndex) => {
                const cells = row.querySelectorAll('td:not(.excel-row-header)');
                cells.forEach((cell, cellIndex) => {
                    if (sampleData[rowIndex] && sampleData[rowIndex][cellIndex]) {
                        cell.textContent = sampleData[rowIndex][cellIndex];
                    }
                });
            });
        }
        
        // Fill reference sample data
        function fillReferenceSample() {
            const table = document.getElementById('referenceTable');
            const rows = table.querySelectorAll('tbody tr');
            
            // Sample data for references
            const sampleData = [
                ['السعر', 'الكمية', 'الإجمالي (نسبي)', 'الإجمالي (مطلق)'],
                ['100', '5', '=A2*B2', '=A2*$B$2'],
                ['200', '3', '=A3*B3', '=A3*$B$2'],
                ['150', '4', '=A4*B4', '=A4*$B$2'],
                ['300', '2', '=A5*B5', '=A5*$B$2']
            ];
            
            // Fill the table
            rows.forEach((row, rowIndex) => {
                const cells = row.querySelectorAll('td:not(.excel-row-header)');
                cells.forEach((cell, cellIndex) => {
                    if (sampleData[rowIndex] && sampleData[rowIndex][cellIndex]) {
                        cell.textContent = sampleData[rowIndex][cellIndex];
                        if (sampleData[rowIndex][cellIndex].startsWith('=')) {
                            cell.classList.add('formula');
                        } else {
                            cell.classList.remove('formula');
                        }
                    }
                });
            });
        }
        
        // Fill VLOOKUP sample data
        function fillVlookupSample() {
            const table = document.getElementById('vlookupTable');
            const rows = table.querySelectorAll('tbody tr');
            
            // Sample data for VLOOKUP
            const sampleData = [
                ['الكود', 'المنتج', 'السعر', 'بحث عن سعر'],
                ['P100', 'حاسوب محمول', '2500', 'P102'],
                ['P101', 'هاتف ذكي', '1800', ''],
                ['P102', 'طابعة', '800', ''],
                ['P103', 'شاشة', '1200', ''],
                ['الصيغة', '', '', '=VLOOKUP(D2,A2:C5,3,FALSE)']
            ];
            
            // Fill the table
            rows.forEach((row, rowIndex) => {
                const cells = row.querySelectorAll('td:not(.excel-row-header)');
                cells.forEach((cell, cellIndex) => {
                    if (sampleData[rowIndex] && sampleData[rowIndex][cellIndex]) {
                        cell.textContent = sampleData[rowIndex][cellIndex];
                        if (sampleData[rowIndex][cellIndex].startsWith('=')) {
                            cell.classList.add('formula');
                        } else {
                            cell.classList.remove('formula');
                        }
                        if (rowIndex === 5) { // Formula row
                            cell.classList.add('result');
                        }
                    }
                });
            });
        }
        
        // Fill sorting sample data
        function fillSortingSample() {
            const table = document.getElementById('sortingTable');
            const rows = table.querySelectorAll('tbody tr');
            
            // Sample data for sorting
            const sampleData = [
                ['الاسم', 'القسم', 'الراتب', 'تاريخ التعيين'],
                ['أحمد محمد', 'المبيعات', '5000', '15/03/2020'],
                ['سارة علي', 'التسويق', '4500', '22/07/2019'],
                ['محمد خالد', 'المبيعات', '5500', '05/01/2021'],
                ['فاطمة عبدالله', 'الدعم الفني', '4000', '18/11/2020'],
                ['خالد سعيد', 'التسويق', '4800', '10/05/2018']
            ];
            
            // Fill the table
            rows.forEach((row, rowIndex) => {
                const cells = row.querySelectorAll('td:not(.excel-row-header)');
                cells.forEach((cell, cellIndex) => {
                    if (sampleData[rowIndex] && sampleData[rowIndex][cellIndex]) {
                        cell.textContent = sampleData[rowIndex][cellIndex];
                    }
                });
            });
        }
        
        // Reset table to initial state
        function resetTable(tableId) {
            const table = document.getElementById(tableId);
            const cells = table.querySelectorAll('td:not(.excel-row-header)');
            
            cells.forEach(cell => {
                cell.textContent = '';
                cell.className = '';
                cell.contentEditable = 'true';
            });
        }
        
        // Toggle solution visibility
        function toggleSolution(id) {
            const solution = document.getElementById(id);
            solution.style.display = solution.style.display === 'none' ? 'block' : 'none';
        }
        
        // Setup tabs functionality
        function setupTabs() {
            const tabs = document.querySelectorAll('.tab');
            
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    // Remove active class from all tabs
                    tabs.forEach(t => t.classList.remove('active'));
                    // Add active class to clicked tab
                    this.classList.add('active');
                    
                    // Hide all categories
                    document.querySelectorAll('.category').forEach(cat => {
                        cat.style.display = 'none';
                    });
                    
                    // Show selected category
                    const categoryId = this.getAttribute('data-category');
                    document.getElementById(categoryId).style.display = 'block';
                    
                    // Scroll to category
                    document.getElementById(categoryId).scrollIntoView({
                        behavior: 'smooth'
                    });
                });
            });
        }
        
        // Setup scroll progress bar
        function setupProgressBar() {
            const progressBar = document.getElementById('progressBar');
            
            window.addEventListener('scroll', function() {
                const scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
                const scrollHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;
                const scrollProgress = (scrollTop / scrollHeight) * 100;
                progressBar.style.width = scrollProgress + '%';
            });
        }
        
        // Setup floating button
        function setupFloatingButton() {
            const fab = document.getElementById('fabButton');
            
            window.addEventListener('scroll', function() {
                if (window.pageYOffset > 300) {
                    fab.classList.add('visible');
                } else {
                    fab.classList.remove('visible');
                }
            });
            
            fab.addEventListener('click', function() {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            });
        }
    </script>
</body>
</html>
