<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تمارين Excel الشاملة</title>
    <style>
        /* CSS */
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-bg: #f5f5f5;
            --card-bg: #ffffff;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.8;
            margin: 0;
            padding: 0;
            background-color: var(--light-bg);
            color: #333;
        }
        
        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 1.5rem;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            margin: 0;
            font-size: 1.8rem;
        }
        
        .developer {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-top: 0.5rem;
        }
        
        .container {
            max-width: 1000px;
            margin: 2rem auto;
            padding: 0 1rem;
        }
        
        .exercise-card {
            background: var(--card-bg);
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border-top: 4px solid var(--secondary-color);
            transition: transform 0.3s ease;
        }
        
        .exercise-card:hover {
            transform: translateY(-3px);
        }
        
        .exercise-title {
            color: var(--primary-color);
            margin-top: 0;
            border-bottom: 1px solid #eee;
            padding-bottom: 0.5rem;
            font-size: 1.3rem;
        }
        
        .excel-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.2rem 0;
            font-size: 0.9rem;
            box-shadow: 0 0 0 1px #ddd;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .excel-table th {
            background-color: var(--primary-color);
            color: white;
            padding: 10px;
            text-align: center;
        }
        
        .excel-table td {
            border: 1px solid #e0e0e0;
            padding: 8px 10px;
            text-align: center;
        }
        
        .excel-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        .btn {
            background: var(--secondary-color);
            color: white;
            border: none;
            padding: 0.6rem 1.2rem;
            border-radius: 6px;
            cursor: pointer;
            margin: 0.5rem 0;
            font-size: 0.9rem;
            transition: all 0.3s;
            display: inline-block;
        }
        
        .btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .solution {
            display: none;
            background: #f0f8ff;
            padding: 1rem;
            margin-top: 1rem;
            border-radius: 6px;
            border-left: 4px solid var(--secondary-color);
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .formula {
            font-family: 'Courier New', Courier, monospace;
            background: #f0f0f0;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            color: #d35400;
            font-weight: bold;
            direction: ltr;
            display: inline-block;
            margin: 0.2rem;
        }
        
        .note {
            background: #fffaf0;
            padding: 0.8rem;
            border-radius: 6px;
            border-left: 4px solid #f39c12;
            margin: 1rem 0;
        }
        
        .footer {
            text-align: center;
            padding: 1.5rem;
            background: var(--primary-color);
            color: white;
            margin-top: 2rem;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 0 0.8rem;
            }
            
            .exercise-card {
                padding: 1rem;
            }
            
            .excel-table {
                font-size: 0.8rem;
            }
            
            .btn {
                padding: 0.5rem 1rem;
                font-size: 0.85rem;
            }
        }
        
        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.5rem;
            }
            
            .developer {
                font-size: 0.8rem;
            }
            
            .excel-table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>تمارين Excel الشاملة</h1>
        <div class="developer">مطور التطبيق: م/مطيع المحجري</div>
    </div>
    
    <div class="container">
        <!-- تمرين COUNT -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 1: دالة COUNT</h2>
            <p>لديك الجدول التالي الذي يحتوي على درجات الطلاب، مع ملاحظة وجود بعض الخلايا الفارغة:</p>
            
            <table class="excel-table">
                <tr>
                    <th>اسم الطالب</th>
                    <th>الدرجة</th>
                </tr>
                <tr>
                    <td>أحمد</td>
                    <td>85</td>
                </tr>
                <tr>
                    <td>محمد</td>
                    <td></td>
                </tr>
                <tr>
                    <td>فاطمة</td>
                    <td>92</td>
                </tr>
                <tr>
                    <td>سارة</td>
                    <td>78</td>
                </tr>
                <tr>
                    <td>خالد</td>
                    <td></td>
                </tr>
            </table>
            
            <p>المطلوب: حساب عدد الطلاب الذين لديهم درجات (تجاهل الخلايا الفارغة)</p>
            <button class="btn" onclick="toggleSolution('sol1')">عرض الحل</button>
            
            <div id="sol1" class="solution">
                <p>لحساب عدد الطلاب الذين لديهم درجات:</p>
                <p class="formula">=COUNT(B2:B6)</p>
                <p>ستكون النتيجة: 3 (لأن هناك خليتين فارغتين)</p>
                
                <div class="note">
                    <strong>ملاحظة:</strong> دالة COUNT تعد فقط الخلايا التي تحتوي على أرقام وتتجاهل النصوص والخلايا الفارغة.
                </div>
            </div>
        </div>
        
        <!-- تمرين COUNTA -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 2: دالة COUNTA</h2>
            <p>لديك الجدول التالي الذي يحتوي على بيانات الموظفين:</p>
            
            <table class="excel-table">
                <tr>
                    <th>اسم الموظف</th>
                    <th>القسم</th>
                    <th>تاريخ التعيين</th>
                </tr>
                <tr>
                    <td>علي</td>
                    <td>المبيعات</td>
                    <td>01/01/2020</td>
                </tr>
                <tr>
                    <td>مريم</td>
                    <td></td>
                    <td>15/03/2021</td>
                </tr>
                <tr>
                    <td></td>
                    <td>التسويق</td>
                    <td></td>
                </tr>
                <tr>
                    <td>سامي</td>
                    <td>المبيعات</td>
                    <td>10/06/2019</td>
                </tr>
            </table>
            
            <p>المطلوب: حساب عدد الخلايا غير الفارغة في عمود "اسم الموظف"</p>
            <button class="btn" onclick="toggleSolution('sol2')">عرض الحل</button>
            
            <div id="sol2" class="solution">
                <p>لحساب عدد الخلايا غير الفارغة في عمود "اسم الموظف":</p>
                <p class="formula">=COUNTA(A2:A5)</p>
                <p>ستكون النتيجة: 3 (لأن هناك خلية واحدة فارغة)</p>
                
                <div class="note">
                    <strong>ملاحظة:</strong> دالة COUNTA تعد جميع الخلايا غير الفارغة بغض النظر عن نوع البيانات (أرقام، نصوص، تواريخ، ...)
                </div>
            </div>
        </div>
        
        <!-- تمرين COUNTBLANK -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 3: دالة COUNTBLANK</h2>
            <p>لديك الجدول التالي الذي يحتوي على استبيان للعملاء:</p>
            
            <table class="excel-table">
                <tr>
                    <th>اسم العميل</th>
                    <th>البريد الإلكتروني</th>
                    <th>رقم الهاتف</th>
                </tr>
                <tr>
                    <td>أحمد</td>
                    <td>ahmed@example.com</td>
                    <td>0512345678</td>
                </tr>
                <tr>
                    <td>محمد</td>
                    <td></td>
                    <td>0511111111</td>
                </tr>
                <tr>
                    <td>فاطمة</td>
                    <td>fatima@example.com</td>
                    <td></td>
                </tr>
                <tr>
                    <td>سارة</td>
                    <td></td>
                    <td></td>
                </tr>
            </table>
            
            <p>المطلوب: حساب عدد العملاء الذين لم يدخلوا بريدهم الإلكتروني</p>
            <button class="btn" onclick="toggleSolution('sol3')">عرض الحل</button>
            
            <div id="sol3" class="solution">
                <p>لحساب عدد الخلايا الفارغة في عمود "البريد الإلكتروني":</p>
                <p class="formula">=COUNTBLANK(B2:B5)</p>
                <p>ستكون النتيجة: 2 (لأن هناك خليتين فارغتين)</p>
                
                <div class="note">
                    <strong>ملاحظة:</strong> دالة COUNTBLANK تعد فقط الخلايا الفارغة تماماً، حتى إذا كانت تحتوي على صيغة تنتج قيمة فارغة.
                </div>
            </div>
        </div>
        
        <!-- تمرين COUNTIF -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 4: دالة COUNTIF</h2>
            <p>لديك الجدول التالي الذي يحتوي على مبيعات المنتجات:</p>
            
            <table class="excel-table">
                <tr>
                    <th>اسم المنتج</th>
                    <th>الكمية المباعة</th>
                    <th>الفرع</th>
                </tr>
                <tr>
                    <td>حاسوب</td>
                    <td>15</td>
                    <td>الرياض</td>
                </tr>
                <tr>
                    <td>هاتف</td>
                    <td>8</td>
                    <td>جدة</td>
                </tr>
                <tr>
                    <td>طابعة</td>
                    <td>12</td>
                    <td>الرياض</td>
                </tr>
                <tr>
                    <td>حاسوب</td>
                    <td>9</td>
                    <td>الدمام</td>
                </tr>
                <tr>
                    <td>هاتف</td>
                    <td>11</td>
                    <td>الرياض</td>
                </tr>
            </table>
            
            <p>المطلوب:</p>
            <ol>
                <li>حساب عدد مرات بيع منتج "حاسوب"</li>
                <li>حساب عدد المنتجات التي بيعت بكمية أكبر من 10</li>
                <li>حساب عدد المبيعات في فرع "الرياض"</li>
            </ol>
            <button class="btn" onclick="toggleSolution('sol4')">عرض الحل</button>
            
            <div id="sol4" class="solution">
                <p>لحل هذا التمرين:</p>
                <ol>
                    <li>عدد مرات بيع الحاسوب: <span class="formula">=COUNTIF(A2:A6, "حاسوب")</span></li>
                    <li>عدد المنتجات التي بيعت بكمية > 10: <span class="formula">=COUNTIF(B2:B6, ">10")</span></li>
                    <li>عدد المبيعات في الرياض: <span class="formula">=COUNTIF(C2:C6, "الرياض")</span></li>
                </ol>
                
                <div class="note">
                    <strong>ملاحظة:</strong> يمكن استخدام معايير مختلفة مع COUNTIF مثل:
                    <ul>
                        <li><span class="formula">">10"</span> لأكبر من 10</li>
                        <li><span class="formula">"<=5"</span> لأصغر من أو يساوي 5</li>
                        <li><span class="formula">"<>جدة"</span> لغير جدة</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- تمرين SUM -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 5: دالة SUM</h2>
            <p>لديك الجدول التالي الذي يحتوي على مبيعات الأقسام:</p>
            
            <table class="excel-table">
                <tr>
                    <th>القسم</th>
                    <th>المبيعات (ريال)</th>
                </tr>
                <tr>
                    <td>الأجهزة الإلكترونية</td>
                    <td>125,000</td>
                </tr>
                <tr>
                    <td>الأثاث</td>
                    <td>85,000</td>
                </tr>
                <tr>
                    <td>الملابس</td>
                    <td>64,500</td>
                </tr>
                <tr>
                    <td>الإكسسوارات</td>
                    <td>32,800</td>
                </tr>
            </table>
            
            <p>المطلوب: حساب إجمالي المبيعات لجميع الأقسام</p>
            <button class="btn" onclick="toggleSolution('sol5')">عرض الحل</button>
            
            <div id="sol5" class="solution">
                <p>لحساب إجمالي المبيعات:</p>
                <p class="formula">=SUM(B2:B5)</p>
                <p>ستكون النتيجة: 307,300 ريال</p>
                
                <div class="note">
                    <strong>نصيحة:</strong> يمكنك أيضاً استخدام زر AutoSum (∑) في شريط الأدوات لحساب المجموع تلقائياً.
                </div>
            </div>
        </div>
        
        <!-- تمرين SUMIF -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 6: دالة SUMIF</h2>
            <p>لديك الجدول التالي الذي يحتوي على مبيعات المندوبين:</p>
            
            <table class="excel-table">
                <tr>
                    <th>اسم المندوب</th>
                    <th>المبيعات (ريال)</th>
                    <th>المنطقة</th>
                </tr>
                <tr>
                    <td>خالد</td>
                    <td>25,000</td>
                    <td>الشمالية</td>
                </tr>
                <tr>
                    <td>نورة</td>
                    <td>18,500</td>
                    <td>الجنوبية</td>
                </tr>
                <tr>
                    <td>سعد</td>
                    <td>32,000</td>
                    <td>الشمالية</td>
                </tr>
                <tr>
                    <td>لمى</td>
                    <td>15,200</td>
                    <td>الشرقية</td>
                </tr>
                <tr>
                    <td>فهد</td>
                    <td>28,750</td>
                    <td>الشمالية</td>
                </tr>
            </table>
            
            <p>المطلوب:</p>
            <ol>
                <li>حساب إجمالي مبيعات المنطقة الشمالية</li>
                <li>حساب إجمالي مبيعات المندوبين الذين تجاوزت مبيعاتهم 20,000 ريال</li>
            </ol>
            <button class="btn" onclick="toggleSolution('sol6')">عرض الحل</button>
            
            <div id="sol6" class="solution">
                <p>لحل هذا التمرين:</p>
                <ol>
                    <li>إجمالي مبيعات المنطقة الشمالية: <span class="formula">=SUMIF(C2:C6, "الشمالية", B2:B6)</span></li>
                    <li>إجمالي مبيعات الذين تجاوزوا 20,000: <span class="formula">=SUMIF(B2:B6, ">20000")</span></li>
                </ol>
                
                <div class="note">
                    <strong>تركيب الدالة:</strong> SUMIF(النطاق, المعيار, [نطاق المجموع])
                    <ul>
                        <li>النطاق: النطاق الذي تريد تقييمه بالمعيار</li>
                        <li>المعيار: الشرط الذي تريد تطبيقه</li>
                        <li>نطاق المجموع: (اختياري) الخلايا التي تريد جمعها إذا تحقق الشرط</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- تمرين TEXT -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 7: دالة TEXT</h2>
            <p>لديك الجدول التالي الذي يحتوي على بعض التواريخ والأرقام:</p>
            
            <table class="excel-table">
                <tr>
                    <th>التاريخ</th>
                    <th>القيمة</th>
                </tr>
                <tr>
                    <td>15/05/2023</td>
                    <td>1250.5</td>
                </tr>
                <tr>
                    <td>22/11/2023</td>
                    <td>875.25</td>
                </tr>
                <tr>
                    <td>03/01/2024</td>
                    <td>1560.75</td>
                </tr>
            </table>
            
            <p>المطلوب:</p>
            <ol>
                <li>تحويل التاريخ إلى نص بالصيغة "يوم، شهر سنة" (مثال: "15 مايو 2023")</li>
                <li>تحويل القيمة إلى نص مع إضافة "ريال" وإظهار منزلتين عشريتين</li>
                <li>دمج التاريخ والقيمة في خلية واحدة بصيغة مقروءة</li>
            </ol>
            <button class="btn" onclick="toggleSolution('sol7')">عرض الحل</button>
            
            <div id="sol7" class="solution">
                <p>لحل هذا التمرين:</p>
                <ol>
                    <li>تحويل التاريخ: <span class="formula">=TEXT(A2, "d mmmm yyyy")</span></li>
                    <li>تحويل القيمة: <span class="formula">=TEXT(B2, "0.00 ""ريال""")</span></li>
                    <li>الدمج: <span class="formula">="في تاريخ " & TEXT(A2, "d mmmm yyyy") & " كانت القيمة " & TEXT(B2, "0.00 ""ريال""")</span></li>
                </ol>
                
                <div class="note">
                    <strong>صيغ TEXT الشائعة:</strong>
                    <ul>
                        <li>التواريخ: "dd/mm/yyyy", "d mmmm yyyy", "dddd" (لاسم اليوم)</li>
                        <li>الأرقام: "0.00", "#,##0", "0%"</li>
                        <li>النصوص: يمكن إضافة نص ثابت بين علامتي تنصيص</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- تمرين AVERAGE -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 8: دالة AVERAGE</h2>
            <p>لديك الجدول التالي الذي يحتوي على درجات الطلاب في 3 اختبارات:</p>
            
            <table class="excel-table">
                <tr>
                    <th>اسم الطالب</th>
                    <th>الاختبار 1</th>
                    <th>الاختبار 2</th>
                    <th>الاختبار 3</th>
                    <th>المعدل</th>
                </tr>
                <tr>
                    <td>أحمد</td>
                    <td>85</td>
                    <td>90</td>
                    <td>78</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>محمد</td>
                    <td>92</td>
                    <td>88</td>
                    <td>95</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>فاطمة</td>
                    <td>78</td>
                    <td>85</td>
                    <td>92</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>المعدل العام</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td></td>
                </tr>
            </table>
            
            <p>المطلوب:</p>
            <ol>
                <li>حساب معدل كل طالب</li>
                <li>حساب المعدل العام لكل اختبار</li>
            </ol>
            <button class="btn" onclick="toggleSolution('sol8')">عرض الحل</button>
            
            <div id="sol8" class="solution">
                <p>لحل هذا التمرين:</p>
                <ol>
                    <li>معدل الطالب أحمد: <span class="formula">=AVERAGE(B2:D2)</span></li>
                    <li>المعدل العام للاختبار 1: <span class="formula">=AVERAGE(B2:B4)</span></li>
                    <li>اسحب الصيغة للأسفل ولليمين حسب الحاجة</li>
                </ol>
                
                <div class="note">
                    <strong>ملاحظة:</strong> دالة AVERAGE تتجاهل الخلايا الفارغة، أما إذا أردت تضمين الخلايا الفارغة كقيم صفرية، استخدم:<br>
                    <span class="formula">=SUM(B2:D2)/3</span>
                </div>
            </div>
        </div>
        
        <!-- تمرين NOW -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 9: دالة NOW</h2>
            <p>المطلوب إنشاء تقرير يتضمن:</p>
            <ol>
                <li>تاريخ ووقت إنشاء التقرير</li>
                <li>حساب عدد الأيام من تاريخ معين حتى اليوم</li>
                <li>إضافة تنبيه إذا كان التاريخ قديم (أكثر من 30 يوم)</li>
            </ol>
            
            <table class="excel-table">
                <tr>
                    <th>عنصر التقرير</th>
                    <th>تاريخ الإنشاء</th>
                    <th>عدد الأيام حتى اليوم</th>
                    <th>الحالة</th>
                </tr>
                <tr>
                    <td>تقرير المبيعات</td>
                    <td>01/05/2023</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>تقرير العملاء</td>
                    <td>15/06/2023</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>تقرير المخزون</td>
                    <td>10/07/2023</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td colspan="3">تاريخ ووقت إنشاء هذا التقرير:</td>
                    <td>?</td>
                </tr>
            </table>
            
            <button class="btn" onclick="toggleSolution('sol9')">عرض الحل</button>
            
            <div id="sol9" class="solution">
                <p>لحل هذا التمرين:</p>
                <ol>
                    <li>تاريخ ووقت إنشاء التقرير: <span class="formula">=NOW()</span></li>
                    <li>عدد الأيام حتى اليوم: <span class="formula">=INT(NOW()-B2)</span></li>
                    <li>الحالة: <span class="formula">=IF(C2>30, "قديم", "حديث")</span></li>
                </ol>
                
                <div class="note">
                    <strong>ملاحظات:</strong>
                    <ul>
                        <li>دالة NOW() تُحدث تلقائياً عند فتح الملف أو إجراء أي عملية حسابية</li>
                        <li>إذا أردت تاريخاً ثابتاً لا يتغير، استخدم CTRL+; للتاريخ و CTRL+SHIFT+; للوقت</li>
                        <li>INT تستخدم لإزالة الكسور وإظهار عدد الأيام كاملاً</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- تمرين ROW -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 10: دالة ROW</h2>
            <p>المطلوب إنشاء جدول ضرب من 1 إلى 10 باستخدام دالة ROW:</p>
            
            <table class="excel-table" id="multiplication-table">
                <tr>
                    <th>×</th>
                    <th>1</th>
                    <th>2</th>
                    <th>3</th>
                    <th>4</th>
                    <th>5</th>
                    <th>6</th>
                    <th>7</th>
                    <th>8</th>
                    <th>9</th>
                    <th>10</th>
                </tr>
                <!-- سيتم إضافة الصفوف بالجافاسكريبت -->
            </table>
            
            <p>المطلوب: استخدام دالة ROW لإنشاء جدول الضرب تلقائياً دون إدخال كل قيمة يدوياً</p>
            <button class="btn" onclick="toggleSolution('sol10')">عرض الحل</button>
            
            <div id="sol10" class="solution">
                <p>لإنشاء جدول الضرب:</p>
                <ol>
                    <li>في الخلية B2 اكتب: <span class="formula">=ROW()</span> (ستظهر 2 لأنها في الصف الثاني)</li>
                    <li>لإنشاء جدول الضرب الكامل:
                        <ul>
                            <li>في الخلية B2: <span class="formula">=ROW(A1)*COLUMN(A1)</span></li>
                            <li>اسحب الصيغة لليمين ولأسفل لملء الجدول</li>
                        </ul>
                    </li>
                </ol>
                
                <div class="note">
                    <strong>استخدامات أخرى لـ ROW:</strong>
                    <ul>
                        <li>إنشاء أرقام تسلسلية: <span class="formula">=ROW()-1</span> إذا بدأت من الصف الثاني</li>
                        <li>استخدامها مع الدوال الأخرى مثل INDEX و INDIRECT</li>
                        <li>إنشاء أنماط متكررة</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- تمرين MAX/MIN -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 11: دوال MAX و MIN</h2>
            <p>لديك الجدول التالي الذي يحتوي على درجات الطلاب في 5 مواد:</p>
            
            <table class="excel-table">
                <tr>
                    <th>اسم الطالب</th>
                    <th>الرياضيات</th>
                    <th>العلوم</th>
                    <th>اللغة العربية</th>
                    <th>اللغة الإنجليزية</th>
                    <th>التاريخ</th>
                    <th>أعلى درجة</th>
                    <th>أقل درجة</th>
                    <th>المدى</th>
                </tr>
                <tr>
                    <td>أحمد</td>
                    <td>85</td>
                    <td>90</td>
                    <td>78</td>
                    <td>88</td>
                    <td>92</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>محمد</td>
                    <td>92</td>
                    <td>88</td>
                    <td>95</td>
                    <td>90</td>
                    <td>85</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>فاطمة</td>
                    <td>78</td>
                    <td>85</td>
                    <td>92</td>
                    <td>95</td>
                    <td>88</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>أعلى درجة في الصف</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td colspan="3"></td>
                </tr>
            </table>
            
            <p>المطلوب:</p>
            <ol>
                <li>إيجاد أعلى درجة لكل طالب</li>
                <li>إيجاد أقل درجة لكل طالب</li>
                <li>حساب المدى (الفرق بين الأعلى والأقل) لكل طالب</li>
                <li>إيجاد أعلى درجة في كل مادة</li>
            </ol>
            <button class="btn" onclick="toggleSolution('sol11')">عرض الحل</button>
            
            <div id="sol11" class="solution">
                <p>لحل هذا التمرين:</p>
                <ol>
                    <li>أعلى درجة للطالب أحمد: <span class="formula">=MAX(B2:F2)</span></li>
                    <li>أقل درجة للطالب أحمد: <span class="formula">=MIN(B2:F2)</span></li>
                    <li>المدى للطالب أحمد: <span class="formula">=G2-H2</span></li>
                    <li>أعلى درجة في الرياضيات: <span class="formula">=MAX(B2:B4)</span></li>
                    <li>اسحب الصيغ للأسفل ولليمين حسب الحاجة</li>
                </ol>
                
                <div class="note">
                    <strong>نصائح:</strong>
                    <ul>
                        <li>يمكن استخدام MAXA و MINA لتضمين القيم المنطقية والنصية</li>
                        <li>لإيجاد ثاني أكبر قيمة استخدم LARGE: <span class="formula">=LARGE(B2:F2, 2)</span></li>
                        <li>لإيجاد ثاني أصغر قيمة استخدم SMALL: <span class="formula">=SMALL(B2:F2, 2)</span></li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- تمرين HYPERLINK -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 12: دالة HYPERLINK</h2>
            <p>المطلوب إنشاء جدول روابط مفيدة:</p>
            
            <table class="excel-table">
                <tr>
                    <th>اسم الموقع</th>
                    <th>الرابط</th>
                    <th>الوصف</th>
                </tr>
                <tr>
                    <td>موقع الوزارة</td>
                    <td>https://www.mohe.gov.sa</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>البوابة الوطنية</td>
                    <td>https://www.saudi.gov.sa</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>التعلم الإلكتروني</td>
                    <td>https://www.moe.gov.sa</td>
                    <td>?</td>
                </tr>
            </table>
            
            <p>المطلوب:</p>
            <ol>
                <li>تحويل عناوين المواقع إلى روابط قابلة للنقر</li>
                <li>إضافة وصف لكل رابط باستخدام HYPERLINK</li>
                <li>إنشاء رابط لفتح بريد إلكتروني</li>
            </ol>
            <button class="btn" onclick="toggleSolution('sol12')">عرض الحل</button>
            
            <div id="sol12" class="solution">
                <p>لحل هذا التمرين:</p>
                <ol>
                    <li>لإنشاء رابط نقر:
                        <ul>
                            <li>الطريقة الأولى: اضغط CTRL+K وأدخل العنوان والنص المعروض</li>
                            <li>الطريقة الثانية: استخدم الدالة <span class="formula">=HYPERLINK("https://www.mohe.gov.sa", "موقع الوزارة")</span></li>
                        </ul>
                    </li>
                    <li>لإضافة وصف: <span class="formula">=HYPERLINK(B2, "الذهاب إلى موقع " & A2)</span></li>
                    <li>رابط بريد إلكتروني: <span class="formula">=HYPERLINK("mailto:support@example.com?subject=استفسار", "اتصل بنا")</span></li>
                </ol>
                
                <div class="note">
                    <strong>إمكانيات إضافية:</strong>
                    <ul>
                        <li>فتح ملف محلي: <span class="formula">=HYPERLINK("C:\Reports\Jan.xlsx", "تقرير يناير")</span></li>
                        <li>الانتقال إلى خلية في نفس الملف: <span class="formula">=HYPERLINK("#Sheet2!A1", "الانتقال إلى Sheet2")</span></li>
                        <li>إضافة نص تلميحي: استخدم خلية مجاورة أو التعليقات</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- تمرين العمليات الحسابية 1 -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 13: العمليات الحسابية الأساسية</h2>
            <p>لديك الجدول التالي الذي يحتوي على بعض القيم:</p>
            
            <table class="excel-table">
                <tr>
                    <th>الرقم 1 (A1)</th>
                    <th>الرقم 2 (B1)</th>
                    <th>الرقم 3 (C1)</th>
                    <th>النتيجة</th>
                </tr>
                <tr>
                    <td>15</td>
                    <td>20</td>
                    <td>5</td>
                    <td>?</td>
                </tr>
            </table>
            
            <p>المطلوب:</p>
            <ol>
                <li>حساب مجموع الأرقام الثلاثة</li>
                <li>حساب حاصل ضرب الرقم الأول في مجموع الرقمين الثاني والثالث</li>
                <li>حساب ناتج قسمة مجموع الأرقام على الرقم الثالث</li>
                <li>حساب مربع الرقم الأول مطروحاً منه جذر الرقم الثاني</li>
            </ol>
            <button class="btn" onclick="toggleSolution('sol13')">عرض الحل</button>
            
            <div id="sol13" class="solution">
                <p>لحل هذا التمرين:</p>
                <ol>
                    <li>مجموع الأرقام: <span class="formula">=A1+B1+C1</span> أو <span class="formula">=SUM(A1:C1)</span></li>
                    <li>حاصل الضرب: <span class="formula">=A1*(B1+C1)</span></li>
                    <li>ناتج القسمة: <span class="formula">=(A1+B1+C1)/C1</span></li>
                    <li>المربع مطروحاً منه الجذر: <span class="formula">=A1^2-SQRT(B1)</span></li>
                </ol>
                
                <div class="note">
                    <strong>ملاحظات:</strong>
                    <ul>
                        <li>أولوية العمليات الحسابية في Excel تتبع القواعد الرياضية المعتادة</li>
                        <li>يمكن استخدام الأقواس لتغيير ترتيب العمليات</li>
                        <li>الأسس تستخدم علامة ^ مثل 2^3 = 8</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- تمرين العمليات الحسابية 2 -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 14: دوال رياضية متقدمة</h2>
            <p>لديك الجدول التالي الذي يحتوي على بعض القيم:</p>
            
            <table class="excel-table">
                <tr>
                    <th>الزاوية (درجات)</th>
                    <th>الرقم</th>
                    <th>النتيجة 1</th>
                    <th>النتيجة 2</th>
                </tr>
                <tr>
                    <td>30</td>
                    <td>16</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>45</td>
                    <td>25</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>60</td>
                    <td>36</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
            </table>
            
            <p>المطلوب:</p>
            <ol>
                <li>حساب جيب الزاوية (بالراديان) مضروباً في جذر الرقم</li>
                <li>حساب جيب تمام الزاوية (بالدرجات) مضروباً في لوغاريتم الرقم للأساس 10</li>
            </ol>
            <button class="btn" onclick="toggleSolution('sol14')">عرض الحل</button>
            
            <div id="sol14" class="solution">
                <p>لحل هذا التمرين:</p>
                <ol>
                    <li>النتيجة 1: <span class="formula">=SIN(RADIANS(A2))*SQRT(B2)</span></li>
                    <li>النتيجة 2: <span class="formula">=COS(RADIANS(A2))*LOG10(B2)</span></li>
                </ol>
                
                <div class="note">
                    <strong>ملاحظات:</strong>
                    <ul>
                        <li>الدوال المثلثية في Excel تستخدم الراديان كوحدة قياس</li>
                        <li>لتحويل الدرجات إلى راديان استخدم RADIANS</li>
                        <li>الدوال المثلثية العكسية تعطي النتيجة بالراديان (استخدم DEGREES لتحويلها لدرجات)</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- تمرين العمليات الحسابية 3 -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 15: دوال التقريب</h2>
            <p>لديك الجدول التالي الذي يحتوي على بعض القيم العشرية:</p>
            
            <table class="excel-table">
                <tr>
                    <th>القيمة</th>
                    <th>ROUND</th>
                    <th>ROUNDUP</th>
                    <th>ROUNDDOWN</th>
                    <th>MROUND</th>
                    <th>INT</th>
                </tr>
                <tr>
                    <td>12.345</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>15.678</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>-8.932</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
            </table>
            
            <p>المطلوب:</p>
            <ol>
                <li>تقريب كل قيمة إلى منزلة عشرية واحدة باستخدام ROUND</li>
                <li>تقريب كل قيمة إلى أعلى (ROUNDUP) إلى منزلتين عشريتين</li>
                <li>تقريب كل قيمة إلى أسفل (ROUNDDOWN) إلى منزلة عشرية واحدة</li>
                <li>تقريب كل قيمة إلى أقرب مضاعف للعدد 3 باستخدام MROUND</li>
                <li>إيجاد الجزء الصحيح من كل قيمة باستخدام INT</li>
            </ol>
            <button class="btn" onclick="toggleSolution('sol15')">عرض الحل</button>
            
            <div id="sol15" class="solution">
                <p>لحل هذا التمرين:</p>
                <ol>
                    <li>ROUND: <span class="formula">=ROUND(A2, 1)</span></li>
                    <li>ROUNDUP: <span class="formula">=ROUNDUP(A2, 2)</span></li>
                    <li>ROUNDDOWN: <span class="formula">=ROUNDDOWN(A2, 1)</span></li>
                    <li>MROUND: <span class="formula">=MROUND(A2, 3)</span></li>
                    <li>INT: <span class="formula">=INT(A2)</span></li>
                </ol>
                
                <div class="note">
                    <strong>ملاحظات:</strong>
                    <ul>
                        <li>ROUND تقرب إلى أقرب قيمة (نصف أو أكثر تقرب لأعلى)</li>
                        <li>ROUNDUP دائماً تقرب لأعلى بغض النظر عن الكسر</li>
                        <li>ROUNDDOWN دائماً تقرب لأسفل بغض النظر عن الكسر</li>
                        <li>MROUND تقرب إلى أقرب مضاعف للعدد المحدد</li>
                        <li>INT تعطي الجزء الصحيح فقط (تقريب لأسفل دائماً)</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- تمرين العمليات الحسابية 4 -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 16: دوال MOD و QUOTIENT</h2>
            <p>لديك الجدول التالي الذي يحتوي على بعض القيم:</p>
            
            <table class="excel-table">
                <tr>
                    <th>البسط</th>
                    <th>المقام</th>
                    <th>الباقي (MOD)</th>
                    <th>حاصل القسمة الصحيح (QUOTIENT)</th>
                    <th>نتيجة الاختبار</th>
                </tr>
                <tr>
                    <td>15</td>
                    <td>4</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>27</td>
                    <td>5</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>100</td>
                    <td>15</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
            </table>
            
            <p>المطلوب:</p>
            <ol>
                <li>حساب باقي القسمة باستخدام MOD</li>
                <li>حساب حاصل القسمة الصحيح (بدون كسور) باستخدام QUOTIENT</li>
                <li>إذا كان باقي القسمة يساوي 0 اكتب "يقبل القسمة" وإلا اكتب "لا يقبل"</li>
            </ol>
            <button class="btn" onclick="toggleSolution('sol16')">عرض الحل</button>
            
            <div id="sol16" class="solution">
                <p>لحل هذا التمرين:</p>
                <ol>
                    <li>الباقي: <span class="formula">=MOD(A2, B2)</span></li>
                    <li>حاصل القسمة الصحيح: <span class="formula">=QUOTIENT(A2, B2)</span></li>
                    <li>نتيجة الاختبار: <span class="formula">=IF(MOD(A2, B2)=0, "يقبل القسمة", "لا يقبل")</span></li>
                </ol>
                
                <div class="note">
                    <strong>استخدامات عملية:</strong>
                    <ul>
                        <li>MOD مفيدة لتحديد الأرقام الزوجية والفردية (MOD(عدد,2)=0 يعني زوجي)</li>
                        <li>QUOTIENT تستخدم عندما نريد جزء القسمة الصحيح فقط</li>
                        <li>يمكن استخدام MOD لإنشاء أنماط متكررة (ألوان متناوبة في الجداول)</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- تمرين العمليات الحسابية 5 -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 17: دوال POWER و SQRT</h2>
            <p>لديك الجدول التالي الذي يحتوي على بعض القيم:</p>
            
            <table class="excel-table">
                <tr>
                    <th>الرقم</th>
                    <th>الأس</th>
                    <th>النتيجة 1</th>
                    <th>النتيجة 2</th>
                </tr>
                <tr>
                    <td>5</td>
                    <td>3</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>16</td>
                    <td>0.5</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>25</td>
                    <td>-2</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
            </table>
            
            <p>المطلوب:</p>
            <ol>
                <li>حساب الرقم مرفوعاً للأس باستخدام POWER</li>
                <li>حساب الجذر التربيعي للرقم باستخدام SQRT</li>
                <li>حساب نفس النتائج باستخدام عوامل التشغيل (^ و *)</li>
            </ol>
            <button class="btn" onclick="toggleSolution('sol17')">عرض الحل</button>
            
            <div id="sol17" class="solution">
                <p>لحل هذا التمرين:</p>
                <ol>
                    <li>POWER: <span class="formula">=POWER(A2, B2)</span></li>
                    <li>SQRT: <span class="formula">=SQRT(A2)</span></li>
                    <li>باستخدام عوامل التشغيل:
                        <ul>
                            <li>الرفع للأس: <span class="formula">=A2^B2</span></li>
                            <li>الجذر التربيعي: <span class="formula">=A2^0.5</span></li>
                        </ul>
                    </li>
                </ol>
                
                <div class="note">
                    <strong>ملاحظات:</strong>
                    <ul>
                        <li>POWER(A,B) تعادل A^B</li>
                        <li>SQRT(A) تعادل A^0.5</li>
                        <li>لحساب الجذر التكعيبي استخدم A^(1/3) أو POWER(A,1/3)</li>
                        <li>الأسس السالبة تعني مقلوب العدد (A^-B = 1/A^B)</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- تمرين العمليات الحسابية 6 -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 18: دوال SUMPRODUCT و ABS</h2>
            <p>لديك الجدول التالي الذي يحتوي على مبيعات المنتجات وأسعارها:</p>
            
            <table class="excel-table">
                <tr>
                    <th>المنتج</th>
                    <th>الكمية</th>
                    <th>السعر</th>
                    <th>الفرق عن المتوسط</th>
                    <th>النتيجة 1</th>
                    <th>النتيجة 2</th>
                </tr>
                <tr>
                    <td>أ</td>
                    <td>15</td>
                    <td>120</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>ب</td>
                    <td>8</td>
                    <td>250</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>ج</td>
                    <td>12</td>
                    <td>180</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>د</td>
                    <td>5</td>
                    <td>300</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
            </table>
            
            <p>المطلوب:</p>
            <ol>
                <li>حساب الفرق بين سعر كل منتج ومتوسط الأسعار (استخدم ABS للقيمة المطلقة)</li>
                <li>حساب إجمالي قيمة المبيعات لكل المنتجات باستخدام SUMPRODUCT</li>
                <li>حساب المتوسط المرجح للأسعار (حسب الكمية المباعة)</li>
            </ol>
            <button class="btn" onclick="toggleSolution('sol18')">عرض الحل</button>
            
            <div id="sol18" class="solution">
                <p>لحل هذا التمرين:</p>
                <ol>
                    <li>الفرق عن المتوسط: <span class="formula">=ABS(C2-AVERAGE($C$2:$C$5))</span></li>
                    <li>إجمالي المبيعات: <span class="formula">=SUMPRODUCT(B2:B5, C2:C5)</span></li>
                    <li>المتوسط المرجح: <span class="formula">=SUMPRODUCT(B2:B5, C2:C5)/SUM(B2:B5)</span></li>
                </ol>
                
                <div class="note">
                    <strong>فوائد SUMPRODUCT:</strong>
                    <ul>
                        <li>تجنب الحاجة إلى عمود وسيط لحساب حاصل الضرب ثم الجمع</li>
                        <li>يمكن استخدامها مع شروط متعددة (بديل قوي لـ SUMIFS)</li>
                        <li>تعمل مع المصفوفات بكفاءة</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- تمرين العمليات الحسابية 7 -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 19: دوال RAND و RANDBETWEEN</h2>
            <p>المطلوب إنشاء جدول يحتوي على:</p>
            
            <table class="excel-table">
                <tr>
                    <th>رقم العينة</th>
                    <th>قيمة عشوائية (0-1)</th>
                    <th>عدد صحيح (1-100)</th>
                    <th>درجة حرارة (15-30)</th>
                    <th>نتيجة اليانصيب (1-49)</th>
                </tr>
                <tr>
                    <td>1</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>5</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
            </table>
            
            <p>المطلوب:</p>
            <ol>
                <li>إنشاء قيم عشوائية بين 0 و 1 باستخدام RAND</li>
                <li>إنشاء أعداد صحيحة بين 1 و 100 باستخدام RANDBETWEEN</li>
                <li>إنشاء قيم لدرجات الحرارة بين 15 و 30 (بمنزلة عشرية واحدة)</li>
                <li>إنشاء أرقام يانصيب بين 1 و 49 (بدون تكرار)</li>
            </ol>
            <button class="btn" onclick="toggleSolution('sol19')">عرض الحل</button>
            
            <div id="sol19" class="solution">
                <p>لحل هذا التمرين:</p>
                <ol>
                    <li>قيمة عشوائية: <span class="formula">=RAND()</span></li>
                    <li>عدد صحيح: <span class="formula">=RANDBETWEEN(1, 100)</span></li>
                    <li>درجة حرارة: <span class="formula">=RANDBETWEEN(150, 300)/10</span></li>
                    <li>أرقام يانصيب (بدون تكرار يتطلب VBA أو استخدام مساعد):</li>
                </ol>
                
                <div class="note">
                    <strong>ملاحظات:</strong>
                    <ul>
                        <li>RAND() تعطي قيم بين 0 و 1 (بما في ذلك 0 ولكن لا تشمل 1)</li>
                        <li>RANDBETWEEN(أدنى, أعلى) تعطي أعداد صحيحة</li>
                        <li>لإنشاء أرقام فريدة بدون تكرار، يمكن استخدام VBA أو إنشاء قائمة طويلة ثم استخدام Remove Duplicates</li>
                        <li>لحفظ القيم العشوائية، انسخها ثم الصقها كقيم (Paste Special → Values)</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- تمرين العمليات الحسابية 8 -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 20: دوال TRUNC و CEILING و FLOOR</h2>
            <p>لديك الجدول التالي الذي يحتوي على بعض القيم العشرية:</p>
            
            <table class="excel-table">
                <tr>
                    <th>القيمة</th>
                    <th>TRUNC</th>
                    <th>CEILING</th>
                    <th>FLOOR</th>
                    <th>التقريب لأقرب 0.05</th>
                </tr>
                <tr>
                    <td>12.345</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>15.678</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>-8.932</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
            </table>
            
            <p>المطلوب:</p>
            <ol>
                <li>استخدام TRUNC لقطع الكسور دون تقريب</li>
                <li>استخدام CEILING للتقريب لأعلى إلى أقرب عدد صحيح</li>
                <li>استخدام FLOOR للتقريب لأسفل إلى أقرب عدد صحيح</li>
                <li>التقريب لأقرب 0.05 (مفيد في الأسعار)</li>
            </ol>
            <button class="btn" onclick="toggleSolution('sol20')">عرض الحل</button>
            
            <div id="sol20" class="solution">
                <p>لحل هذا التمرين:</p>
                <ol>
                    <li>TRUNC: <span class="formula">=TRUNC(A2)</span> أو <span class="formula">=TRUNC(A2,0)</span></li>
                    <li>CEILING: <span class="formula">=CEILING(A2,1)</span></li>
                    <li>FLOOR: <span class="formula">=FLOOR(A2,1)</span></li>
                    <li>التقريب لـ 0.05: <span class="formula">=MROUND(A2,0.05)</span></li>
                </ol>
                
                <div class="note">
                    <strong>الفرق بين INT و TRUNC:</strong>
                    <ul>
                        <li>INT و TRUNC يعطيان نفس النتيجة للأعداد الموجبة</li>
                        <li>للأعداد السالبة: INT(-3.2)=-4 بينما TRUNC(-3.2)=-3</li>
                        <li>TRUNC يمكنها قطع أي عدد من المنازل العشرية: TRUNC(12.345,2)=12.34</li>
                        <li>CEILING و FLOOR يمكن استخدامهما لأي مضاعف (0.5، 10، إلخ)</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- تمرين العمليات الحسابية 9 -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 21: دوال SUMIFS و AVERAGEIFS</h2>
            <p>لديك الجدول التالي الذي يحتوي على مبيعات المنتجات:</p>
            
            <table class="excel-table">
                <tr>
                    <th>المنتج</th>
                    <th>المنطقة</th>
                    <th>المندوب</th>
                    <th>الكمية</th>
                    <th>السعر</th>
                    <th>القيمة</th>
                </tr>
                <tr>
                    <td>حاسوب</td>
                    <td>الشمالية</td>
                    <td>أحمد</td>
                    <td>5</td>
                    <td>1200</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>هاتف</td>
                    <td>الجنوبية</td>
                    <td>مريم</td>
                    <td>8</td>
                    <td>800</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>حاسوب</td>
                    <td>الشرقية</td>
                    <td>خالد</td>
                    <td>3</td>
                    <td>1200</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>طابعة</td>
                    <td>الشمالية</td>
                    <td>أحمد</td>
                    <td>6</td>
                    <td>500</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>هاتف</td>
                    <td>الشمالية</td>
                    <td>سارة</td>
                    <td>4</td>
                    <td>800</td>
                    <td>?</td>
                </tr>
            </table>
            
            <p>المطلوب:</p>
            <ol>
                <li>حساب القيمة الإجمالية لكل بند (الكمية × السعر)</li>
                <li>حساب إجمالي مبيعات المنطقة الشمالية لمنتج "حاسوب"</li>
                <li>حساب متوسط سعر منتجات "هاتف" في المناطق غير الجنوبية</li>
                <li>حساب إجمالي مبيعات المندوب "أحمد" لمنتجات بأكثر من 4 قطع</li>
            </ol>
            <button class="btn" onclick="toggleSolution('sol21')">عرض الحل</button>
            
            <div id="sol21" class="solution">
                <p>لحل هذا التمرين:</p>
                <ol>
                    <li>القيمة: <span class="formula">=D2*E2</span></li>
                    <li>مبيعات الشمالية لحاسوب: <span class="formula">=SUMIFS(F2:F6, A2:A6, "حاسوب", B2:B6, "الشمالية")</span></li>
                    <li>متوسط سعر الهاتف خارج الجنوبية: <span class="formula">=AVERAGEIFS(E2:E6, A2:A6, "هاتف", B2:B6, "<>الجنوبية")</span></li>
                    <li>مبيعات أحمد لأكثر من 4 قطع: <span class="formula">=SUMIFS(F2:F6, C2:C6, "أحمد", D2:D6, ">4")</span></li>
                </ol>
                
                <div class="note">
                    <strong>ملاحظات:</strong>
                    <ul>
                        <li>SUMIFS و AVERAGEIFS تأخذ المعيار الأول ثم نطاق التقييم الأول</li>
                        <li>يمكن إضافة أي عدد من أزواج المعايير/النطاقات</li>
                        <li>للاستخدام مع تواريخ: <span class="formula">=SUMIFS(النطاق, نطاق_التواريخ, ">=1/1/2023", نطاق_التواريخ, "<=31/12/2023")</span></li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- تمرين العمليات الحسابية 10 -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 22: دوال COUNTIFS و AGGREGATE</h2>
            <p>لديك الجدول التالي الذي يحتوي على بيانات الموظفين:</p>
            
            <table class="excel-table">
                <tr>
                    <th>اسم الموظف</th>
                    <th>القسم</th>
                    <th>الراتب</th>
                    <th>تاريخ التعيين</th>
                    <th>العمر</th>
                </tr>
                <tr>
                    <td>أحمد</td>
                    <td>المبيعات</td>
                    <td>8500</td>
                    <td>15/03/2018</td>
                    <td>32</td>
                </tr>
                <tr>
                    <td>مريم</td>
                    <td>التسويق</td>
                    <td>9200</td>
                    <td>22/07/2020</td>
                    <td>28</td>
                </tr>
                <tr>
                    <td>خالد</td>
                    <td>المبيعات</td>
                    <td>7800</td>
                    <td>10/11/2019</td>
                    <td>35</td>
                </tr>
                <tr>
                    <td>سارة</td>
                    <td>التطوير</td>
                    <td>10500</td>
                    <td>05/01/2017</td>
                    <td>40</td>
                </tr>
                <tr>
                    <td>ناصر</td>
                    <td>المبيعات</td>
                    <td>8100</td>
                    <td>30/09/2021</td>
                    <td>29</td>
                </tr>
            </table>
            
            <p>المطلوب:</p>
            <ol>
                <li>حساب عدد موظفي المبيعات الذين رواتبهم أكثر من 8000</li>
                <li>حساب عدد الموظفين المعينين بعد 1/1/2020 وعمرهم أقل من 30</li>
                <li>حساب متوسط رواتب الموظفين الذين ليسوا من قسم المبيعات (باستخدام AGGREGATE)</li>
                <li>حساب أعلى راتب في قسم المبيعات (باستخدام AGGREGATE)</li>
            </ol>
            <button class="btn" onclick="toggleSolution('sol22')">عرض الحل</button>
            
            <div id="sol22" class="solution">
                <p>لحل هذا التمرين:</p>
                <ol>
                    <li>موظفو المبيعات برواتب >8000: <span class="formula">=COUNTIFS(B2:B6, "المبيعات", C2:C6, ">8000")</span></li>
                    <li>موظفون جدد وعمرهم <30: <span class="formula">=COUNTIFS(D2:D6, ">1/1/2020", E2:E6, "<30")</span></li>
                    <li>متوسط رواتب غير المبيعات: <span class="formula">=AGGREGATE(1, 3, C2:C6/(B2:B6<>"المبيعات"))</span></li>
                    <li>أعلى راتب في المبيعات: <span class="formula">=AGGREGATE(14, 3, C2:C6/(B2:B6="المبيعات"), 1)</span></li>
                </ol>
                
                <div class="note">
                    <strong>مميزات AGGREGATE:</strong>
                    <ul>
                        <li>تقدم 19 وظيفة مختلفة (SUM, AVERAGE, MAX, MIN, ...)</li>
                        <li>تتجاهل القيم المخفية أو المصفوفات الفرعية</li>
                        <li>يمكنها التعامل مع المصفوفات دون CTRL+SHIFT+ENTER</li>
                        <li>الخيارات تسمح بتجاهل الأخطاء أو القيم المخفية</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- تمرين العمليات الحسابية 11 -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 23: دوال SUBTOTAL و ROMAN</h2>
            <p>لديك الجدول التالي الذي يحتوي على مبيعات فروع متعددة:</p>
            
            <table class="excel-table">
                <tr>
                    <th>الفرع</th>
                    <th>الشهر</th>
                    <th>المبيعات</th>
                    <th>الرقم</th>
                    <th>النتيجة 1</th>
                    <th>النتيجة 2</th>
                </tr>
                <tr>
                    <td>الرياض</td>
                    <td>يناير</td>
                    <td>125000</td>
                    <td>4</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>جدة</td>
                    <td>يناير</td>
                    <td>98000</td>
                    <td>7</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>الدمام</td>
                    <td>يناير</td>
                    <td>115000</td>
                    <td>12</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>الرياض</td>
                    <td>فبراير</td>
                    <td>135000</td>
                    <td>15</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>جدة</td>
                    <td>فبراير</td>
                    <td>105000</td>
                    <td>21</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>الدمام</td>
                    <td>فبراير</td>
                    <td>125000</td>
                    <td>49</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td colspan="2">المجموع</td>
                    <td>?</td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
            </table>
            
            <p>المطلوب:</p>
            <ol>
                <li>حساب مجموع المبيعات باستخدام SUBTOTAL (للتأكد من تجاهل أي صفوف مخفية)</li>
                <li>تحويل الأرقام في العمود D إلى أرقام رومانية باستخدام ROMAN</li>
                <li>حساب متوسط المبيعات باستخدام SUBTOTAL مع تجاهل الصفوف المخفية</li>
                <li>إنشاء مرجع للجدول مثل "الفصل الثاني" باستخدام ROMAN</li>
            </ol>
            <button class="btn" onclick="toggleSolution('sol23')">عرض الحل</button>
            
            <div id="sol23" class="solution">
                <p>لحل هذا التمرين:</p>
                <ol>
                    <li>مجموع المبيعات: <span class="formula">=SUBTOTAL(9, C2:C7)</span> (9 تمثل SUM في SUBTOTAL)</li>
                    <li>تحويل إلى روماني: <span class="formula">=ROMAN(D2)</span></li>
                    <li>متوسط المبيعات: <span class="formula">=SUBTOTAL(1, C2:C7)</span> (1 تمثل AVERAGE)</li>
                    <li>مرجع جدول: <span class="formula">="الفصل " & ROMAN(2)</span> سيعطي "الفصل II"</li>
                </ol>
                
                <div class="note">
                    <strong>فوائد SUBTOTAL:</strong>
                    <ul>
                        <li>تتجاهل الصفوف المخفية عند التصفية</li>
                        <li>تتجنب تضمين نتائج SUBTOTAL أخرى في الحساب</li>
                        <li>توفر 11 وظيفة مختلفة (1-11 تتجاهل المخفي، 101-111 تتجاهل المخفي والمصفوفات الفرعية)</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- تمرين العمليات الحسابية 12 -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 24: دوال FACT و COMBIN</h2>
            <p>لديك الجدول التالي الذي يحتوي على بعض القيم:</p>
            
            <table class="excel-table">
                <tr>
                    <th>العدد</th>
                    <th>المجموعة</th>
                    <th>الاختيارات</th>
                    <th>النتيجة 1</th>
                    <th>النتيجة 2</th>
                    <th>النتيجة 3</th>
                </tr>
                <tr>
                    <td>5</td>
                    <td>10</td>
                    <td>3</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>6</td>
                    <td>15</td>
                    <td>4</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>7</td>
                    <td>20</td>
                    <td>5</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
            </table>
            
            <p>المطلوب:</p>
            <ol>
                <li>حساب مضروب العدد (FACT)</li>
                <li>حساب عدد التوليفات الممكنة (COMBIN)</li>
                <li>حساب عدد التباديل (PERMUT)</li>
                <li>حساب الاحتمال باختيار 3 من 10 مع 5 عناصر ناجحة (HYPGEOM.DIST)</li>
            </ol>
            <button class="btn" onclick="toggleSolution('sol24')">عرض الحل</button>
            
            <div id="sol24" class="solution">
                <p>لحل هذا التمرين:</p>
                <ol>
                    <li>مضروب العدد: <span class="formula">=FACT(A2)</span> (5! = 120)</li>
                    <li>عدد التوليفات: <span class="formula">=COMBIN(B2, C2)</span> (اختيار 3 من 10)</li>
                    <li>عدد التباديل: <span class="formula">=PERMUT(B2, C2)</span></li>
                    <li>الاحتمال: <span class="formula">=HYPGEOM.DIST(C2, B2, 5, 10, FALSE)</span></li>
                </ol>
                
                <div class="note">
                    <strong>تطبيقات عملية:</strong>
                    <ul>
                        <li>FACT تستخدم في حسابات الاحتمالات والترتيبات</li>
                        <li>COMBIN تستخدم عند اختيار مجموعة دون مراعاة الترتيب</li>
                        <li>PERMUT تستخدم عند اختيار مجموعة مع مراعاة الترتيب</li>
                        <li>HYPGEOM.DIST لحساب احتمالية العينات من دون إرجاع</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- تمرين العمليات الحسابية 13 -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 25: دوال GCD و LCM</h2>
            <p>لديك الجدول التالي الذي يحتوي على بعض الأعداد:</p>
            
            <table class="excel-table">
                <tr>
                    <th>العدد 1</th>
                    <th>العدد 2</th>
                    <th>العدد 3</th>
                    <th>القاسم المشترك الأكبر</th>
                    <th>المضاعف المشترك الأصغر</th>
                </tr>
                <tr>
                    <td>12</td>
                    <td>18</td>
                    <td>24</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>15</td>
                    <td>25</td>
                    <td>35</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>8</td>
                    <td>12</td>
                    <td>16</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
            </table>
            
            <p>المطلوب:</p>
            <ol>
                <li>حساب القاسم المشترك الأكبر (GCD) للأعداد الثلاثة</li>
                <li>حساب المضاعف المشترك الأصغر (LCM) للأعداد الثلاثة</li>
                <li>حساب نسبة تبسيط الكسور باستخدام GCD</li>
                <li>حساب متى ستتزامن الأحداث الدورية باستخدام LCM</li>
            </ol>
            <button class="btn" onclick="toggleSolution('sol25')">عرض الحل</button>
            
            <div id="sol25" class="solution">
                <p>لحل هذا التمرين:</p>
                <ol>
                    <li>GCD: <span class="formula">=GCD(A2, B2, C2)</span></li>
                    <li>LCM: <span class="formula">=LCM(A2, B2, C2)</span></li>
                    <li>تبسيط الكسر 18/24: <span class="formula">=B2/GCD(B2,C2) & "/" & C2/GCD(B2,C2)</span></li>
                    <li>تزامن أحداث كل 12 و18 و24 يوم: <span class="formula">=LCM(A2,B2,C2) & " يوم"</span></li>
                </ol>
                
                <div class="note">
                    <strong>استخدامات عملية:</strong>
                    <ul>
                        <li>GCD مفيد لتبسيط الكسور إلى أبسط صورة</li>
                        <li>LCM مفيد لحساب مواعيد التكرار المشتركة</li>
                        <li>يمكن استخدام GCD للتحقق من قابلية القسمة</li>
                        <li>LCM يستخدم في مشاكل التزامن والتكرار</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- تمرين العمليات الحسابية 14 -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 26: دوال PRODUCT و QUOTIENT</h2>
            <p>لديك الجدول التالي الذي يحتوي على بعض القيم:</p>
            
            <table class="excel-table">
                <tr>
                    <th>العدد 1</th>
                    <th>العدد 2</th>
                    <th>العدد 3</th>
                    <th>حاصل الضرب</th>
                    <th>حاصل القسمة الصحيح</th>
                    <th>حاصل ضرب الأعداد الفردية</th>
                </tr>
                <tr>
                    <td>5</td>
                    <td>8</td>
                    <td>3</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>12</td>
                    <td>7</td>
                    <td>4</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>9</td>
                    <td>6</td>
                    <td>11</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
            </table>
            
            <p>المطلوب:</p>
            <ol>
                <li>حساب حاصل ضرب الأعداد الثلاثة باستخدام PRODUCT</li>
                <li>حساب حاصل قسمة العدد الأول على الثاني (قسمة صحيحة) باستخدام QUOTIENT</li>
                <li>حساب حاصل ضرب الأعداد الفردية فقط من الأعداد الثلاثة</li>
                <li>حساب نسبة حاصل الضرب إلى حاصل القسمة</li>
            </ol>
            <button class="btn" onclick="toggleSolution('sol26')">عرض الحل</button>
            
            <div id="sol26" class="solution">
                <p>لحل هذا التمرين:</p>
                <ol>
                    <li>حاصل الضرب: <span class="formula">=PRODUCT(A2:C2)</span></li>
                    <li>حاصل القسمة الصحيح: <span class="formula">=QUOTIENT(A2, B2)</span></li>
                    <li>ضرب الأعداد الفردية: <span class="formula">=PRODUCT(IF(MOD(A2,2)=1,A2,1), IF(MOD(B2,2)=1,B2,1), IF(MOD(C2,2)=1,C2,1))</span></li>
                    <li>النسبة: <span class="formula">=D2/E2</span></li>
                </ol>
                
                <div class="note">
                    <strong>ملاحظات:</strong>
                    <ul>
                        <li>PRODUCT تتجاهل الخلايا الفارغة والنصوص</li>
                        <li>QUOTIENT تعادل INT(A2/B2) ولكنها أسرع</li>
                        <li>لضرب شروط معقدة يمكن استخدام PRODUCT مع IF</li>
                        <li>لضرب نطاق كامل مع شروط، يمكن استخدام صيغة المصفوفة: <span class="formula">{=PRODUCT(IF(MOD(A2:C2,2)=1,A2:C2,1))}</span></li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- تمرين العمليات الحسابية 15 -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 27: دوال SUMSQ و SUMX2PY2</h2>
            <p>لديك الجدول التالي الذي يحتوي على بعض القيم:</p>
            
            <table class="excel-table">
                <tr>
                    <th>المجموعة 1</th>
                    <th>المجموعة 2</th>
                    <th>مجموع المربعات</th>
                    <th>مجموع مربعات المجموعتين</th>
                    <th>الفرق بين المربعات</th>
                </tr>
                <tr>
                    <td>3</td>
                    <td>4</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>5</td>
                    <td>12</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>8</td>
                    <td>15</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
            </table>
            
            <p>المطلوب:</p>
            <ol>
                <li>حساب مجموع مربعات الأعداد في كل مجموعة باستخدام SUMSQ</li>
                <li>حساب مجموع مربعات الأعداد من المجموعتين معاً (3²+4² + 4²+3²) باستخدام SUMX2PY2</li>
                <li>حساب الفرق بين مجموع المربعات للمجموعتين</li>
                <li>حساب الجذر التربيعي لمجموع المربعات (لحساب الوتر في المثلث القائم)</li>
            </ol>
            <button class="btn" onclick="toggleSolution('sol27')">عرض الحل</button>
            
            <div id="sol27" class="solution">
                <p>لحل هذا التمرين:</p>
                <ol>
                    <li>مجموع المربعات: <span class="formula">=SUMSQ(A2:B2)</span></li>
                    <li>SUMX2PY2: <span class="formula">=SUMX2PY2(A2:B2, B2:A2)</span></li>
                    <li>الفرق بين المربعات: <span class="formula">=SUMSQ(A2)-SUMSQ(B2)</span></li>
                    <li>الوتر: <span class="formula">=SQRT(SUMSQ(A2:B2))</span></li>
                </ol>
                
                <div class="note">
                    <strong>تطبيقات عملية:</strong>
                    <ul>
                        <li>SUMSQ تستخدم في الحسابات الإحصائية والهندسية</li>
                        <li>SUMX2PY2 تستخدم في حسابات المسافات بين نقاط</li>
                        <li>لحساب المسافة الإقليدية بين نقطتين: <span class="formula">=SQRT(SUMX2PY2(A2:B2, A3:B3)-2*SUMPRODUCT(A2:B2,A3:B3))</span></li>
                        <li>في الفيزياء، تستخدم لحساب الطاقة الحركية أو طاقة الوضع</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- تمرين العمليات الحسابية 16 -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 28: دوال SERIESSUM و SIGN</h2>
            <p>لديك الجدول التالي الذي يحتوي على بعض القيم:</p>
            
            <table class="excel-table">
                <tr>
                    <th>العدد X</th>
                    <th>القوة N</th>
                    <th>الخطوة M</th>
                    <th>المعاملات</th>
                    <th>مجموع المتسلسلة</th>
                    <th>إشارة النتيجة</th>
                </tr>
                <tr>
                    <td>2</td>
                    <td>0</td>
                    <td>1</td>
                    <td>1, 1/2, 1/6, 1/24</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>-1.5</td>
                    <td>1</td>
                    <td>2</td>
                    <td>1, -1, 1, -1</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>0.5</td>
                    <td>2</td>
                    <td>1</td>
                    <td>1, 1, 1, 1</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
            </table>
            
            <p>المطلوب:</p>
            <ol>
                <li>حساب مجموع المتسلسلة باستخدام SERIESSUM (لحساب e^X تقريباً)</li>
                <li>تحديد إشارة النتيجة باستخدام SIGN</li>
                <li>حساب متسلسلة أخرى لتمثيل دالة جيبية</li>
                <li>تحويل النتيجة إلى نسبة مئوية إذا كانت موجبة</li>
            </ol>
            <button class="btn" onclick="toggleSolution('sol28')">عرض الحل</button>
            
            <div id="sol28" class="solution">
                <p>لحل هذا التمرين:</p>
                <ol>
                    <li>مجموع المتسلسلة: <span class="formula">=SERIESSUM(A2, B2, C2, {1,1/2,1/6,1/24})</span></li>
                    <li>الإشارة: <span class="formula">=SIGN(E2)</span></li>
                    <li>متسلسلة جيبية: <span class="formula">=SERIESSUM(A2, B2, C2, {0,1,-1/6,1/120})</span></li>
                    <li>نسبة مئوية إذا موجبة: <span class="formula">=IF(SIGN(E2)=1, TEXT(E2,"0.00%"), "سالبة")</span></li>
                </ol>
                
                <div class="note">
                    <strong>شرح SERIESSUM:</strong>
                    <p>دالة SERIESSUM تحسب مجموع متسلسلة قوى بالصيغة:<br>
                    <span class="formula">a<sub>1</sub>x<sup>n</sup> + a<sub>2</sub>x<sup>n+m</sup> + a<sub>3</sub>x<sup>n+2m</sup> + ... + a<sub>i</sub>x<sup>n+(i-1)m</sup></span></p>
                    <p>حيث:<br>
                    - x هو القيمة الأساسية<br>
                    - n هي القوة الأولية لـ x<br>
                    - m هي الخطوة التي تزيد بها القوة<br>
                    - a<sub>i</sub> هي معاملات المتسلسلة</p>
                </div>
            </div>
        </div>
        
        <!-- تمرين العمليات الحسابية 17 -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 29: دوال PI و SQRTPI</h2>
            <p>لديك الجدول التالي الذي يحتوي على بعض القيم:</p>
            
            <table class="excel-table">
                <tr>
                    <th>نصف القطر</th>
                    <th>مساحة الدائرة</th>
                    <th>محيط الدائرة</th>
                    <th>حجم الكرة</th>
                    <th>نتيجة خاصة</th>
                </tr>
                <tr>
                    <td>5</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>7.5</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>10</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
            </table>
            
            <p>المطلوب:</p>
            <ol>
                <li>حساب مساحة الدائرة باستخدام PI</li>
                <li>حساب محيط الدائرة باستخدام PI</li>
                <li>حساب حجم الكرة باستخدام PI</li>
                <li>حساب الجذر التربيعي لـ (نصف القطر × π) باستخدام SQRTPI</li>
            </ol>
            <button class="btn" onclick="toggleSolution('sol29')">عرض الحل</button>
            
            <div id="sol29" class="solution">
                <p>لحل هذا التمرين:</p>
                <ol>
                    <li>مساحة الدائرة: <span class="formula">=PI()*A2^2</span></li>
                    <li>محيط الدائرة: <span class="formula">=2*PI()*A2</span></li>
                    <li>حجم الكرة: <span class="formula">=(4/3)*PI()*A2^3</span></li>
                    <li>نتيجة خاصة: <span class="formula">=SQRTPI(A2)</span> (تعادل SQRT(A2*PI()))</li>
                </ol>
                
                <div class="note">
                    <strong>استخدامات PI:</strong>
                    <ul>
                        <li>PI() تعطي قيمة π بدقة 15 رقم عشري (~3.14159265358979)</li>
                        <li>تستخدم في جميع الحسابات الهندسية الدائرية أو الكروية</li>
                        <li>SQRTPI مفيدة في بعض التطبيقات الإحصائية والفيزيائية</li>
                        <li>لحساب مساحة سطح الكرة: <span class="formula">=4*PI()*A2^2</span></li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- تمرين العمليات الحسابية 18 -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 30: دوال TREND و GROWTH</h2>
            <p>لديك الجدول التالي الذي يحتوي على بيانات المبيعات الشهرية:</p>
            
            <table class="excel-table">
                <tr>
                    <th>الشهر</th>
                    <th>المبيعات الخطية</th>
                    <th>المبيعات الأسية</th>
                    <th>التنبؤ الخطي</th>
                    <th>التنبؤ الأسي</th>
                </tr>
                <tr>
                    <td>1</td>
                    <td>120</td>
                    <td>50</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>135</td>
                    <td>75</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>150</td>
                    <td>112.5</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>165</td>
                    <td>168.75</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>5</td>
                    <td>180</td>
                    <td>253.125</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>6</td>
                    <td></td>
                    <td></td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>7</td>
                    <td></td>
                    <td></td>
                    <td>?</td>
                    <td>?</td>
                </tr>
            </table>
            
            <p>المطلوب:</p>
            <ol>
                <li>حساب التنبؤ الخطي للمبيعات لشهري 6 و7 باستخدام TREND</li>
                <li>حساب التنبؤ الأسي للمبيعات لشهري 6 و7 باستخدام GROWTH</li>
                <li>مقارنة النتائج بين النموذج الخطي والأسي</li>
                <li>حساب نسبة النمو المتوقعة في النموذج الأسي</li>
            </ol>
            <button class="btn" onclick="toggleSolution('sol30')">عرض الحل</button>
            
            <div id="sol30" class="solution">
                <p>لحل هذا التمرين:</p>
                <ol>
                    <li>التنبؤ الخطي لشهر 6: <span class="formula">=TREND(B2:B6, A2:A6, A7)</span></li>
                    <li>التنبؤ الأسي لشهر 6: <span class="formula">=GROWTH(C2:C6, A2:A6, A7)</span></li>
                    <li>مقارنة النتائج: حساب الفرق بين النموذجين</li>
                    <li>نسبة النمو: <span class="formula">=(GROWTH(C2:C6, A2:A6, A7)/C5)-1</span></li>
                </ol>
                
                <div class="note">
                    <strong>ملاحظات:</strong>
                    <ul>
                        <li>TREND تستخدم للعلاقات الخطية (y = mx + b)</li>
                        <li>GROWTH تستخدم للعلاقات الأسية (y = b*m^x)</li>
                        <li>لحساب القيم السابقة (التنبؤ الرجعي)، استخدم نفس الدوال مع قيم x المطلوبة</li>
                        <li>لرؤية جميع المعاملات، استخدم LINEST للخطي أو LOGEST للأسي</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- تمرين العمليات الحسابية 19 -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 31: دوال LOG و LN</h2>
            <p>لديك الجدول التالي الذي يحتوي على بعض القيم:</p>
            
            <table class="excel-table">
                <tr>
                    <th>العدد</th>
                    <th>LOG10</th>
                    <th>LN</th>
                    <th>LOG (الأساس 2)</th>
                    <th>e^العدد</th>
                    <th>10^العدد</th>
                </tr>
                <tr>
                    <td>1</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>10</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>100</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>2.71828</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
            </table>
            
            <p>المطلوب:</p>
            <ol>
                <li>حساب لوغاريتم العدد للأساس 10 باستخدام LOG10</li>
                <li>حساب لوغاريتم العدد للأساس e (اللوغاريتم الطبيعي) باستخدام LN</li>
                <li>حساب لوغاريتم العدد للأساس 2 باستخدام LOG</li>
                <li>حساب e مرفوعة للقوة العدد باستخدام EXP</li>
                <li>حساب 10 مرفوعة للقوة العدد</li>
            </ol>
            <button class="btn" onclick="toggleSolution('sol31')">عرض الحل</button>
            
            <div id="sol31" class="solution">
                <p>لحل هذا التمرين:</p>
                <ol>
                    <li>LOG10: <span class="formula">=LOG10(A2)</span></li>
                    <li>LN: <span class="formula">=LN(A2)</span></li>
                    <li>LOG للأساس 2: <span class="formula">=LOG(A2, 2)</span></li>
                    <li>EXP: <span class="formula">=EXP(A2)</span></li>
                    <li>10^العدد: <span class="formula">=10^A2</span></li>
                </ol>
                
                <div class="note">
                    <strong>علاقات لوغاريتمية:</strong>
                    <ul>
                        <li>LOG(X,10) = LOG10(X)</li>
                        <li>LOG(X,2) = LOG(X,2)</li>
                        <li>LOG(X) بدون أساس يعطي LOG10(X) في بعض الإصدارات</li>
                        <li>لتحويل بين اللوغاريتمات: <span class="formula">LOG(X,B) = LN(X)/LN(B)</span></li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- تمرين العمليات الحسابية 20 -->
        <div class="exercise-card">
            <h2 class="exercise-title">التمرين 32: دوال CONVERT و COMPLEX</h2>
            <p>لديك الجدول التالي الذي يحتوي على بعض القيم:</p>
            
            <table class="excel-table">
                <tr>
                    <th>القيمة</th>
                    <th>الوحدة الحالية</th>
                    <th>الوحدة المطلوبة</th>
                    <th>الجزء الحقيقي</th>
                    <th>الجزء التخيلي</th>
                    <th>النتيجة 1</th>
                    <th>النتيجة 2</th>
                </tr>
                <tr>
                    <td>100</td>
                    <td>km</td>
                    <td>m</td>
                    <td>3</td>
                    <td>4</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>25</td>
                    <td>C</td>
                    <td>F</td>
                    <td>5</td>
                    <td>-2</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
                <tr>
                    <td>180</td>
                    <td>min</td>
                    <td>hr</td>
                    <td>0</td>
                    <td>1.5</td>
                    <td>?</td>
                    <td>?</td>
                </tr>
            </table>
            
            <p>المطلوب:</p>
            <ol>
                <li>تحويل الوحدات باستخدام CONVERT</li>
                <li>إنشاء عدد مركب باستخدام COMPLEX</li>
                <li>حساب مرافق العدد المركب باستخدام IMAGINARY</li>
                <li>حساب مقدار العدد المركب (القياس)</li>
            </ol>
            <button class="btn" onclick="toggleSolution('sol32')">عرض الحل</button>
            
            <div id="sol32" class="solution">
                <p>لحل هذا التمرين:</p>
                <ol>
                    <li>تحويل الوحدات: <span class="formula">=CONVERT(A2, B2, C2)</span></li>
                    <li>العدد المركب: <span class="formula">=COMPLEX(D2, E2)</span></li>
                    <li>المرافق: <span class="formula">=IMCONJUGATE(F2)</span></li>
                    <li>المقدار: <span class="formula">=IMABS(F2)</span></li>
                </ol>
                
                <div class="note">
                    <strong>ملاحظات:</strong>
                    <ul>
                        <li>CONVERT تدعم العديد من الوحدات (الطول، الوزن، الحرارة، الوقت، الطاقة، ...)</li>
                        <li>لتحويل درجات الحرارة: "C" لسيليسيوس، "F" لفهرنهايت، "K" لكلفن</li>
                        <li>الدوال المركبة تتطلب تحميل الوظيفة الإضافية "Analysis ToolPak" في إصدارات قديمة</li>
                        <li>لحساب الزاوية (الطور): <span class="formula">=IMARGUMENT(F2)</span></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <div class="footer">
        تم تطوير هذا التطبيق التعليمي بواسطة م/مطيع المحجري &copy; 2025
    </div>

    <script>
        // JavaScript
        function toggleSolution(id) {
            const solution = document.getElementById(id);
            solution.style.display = solution.style.display === "block" ? "none" : "block";
        }
        
        // إنشاء جدول الضرب باستخدام JavaScript
        document.addEventListener('DOMContentLoaded', function() {
            const table = document.getElementById('multiplication-table');
            
            for (let i = 1; i <= 10; i++) {
                const row = document.createElement('tr');
                row.innerHTML = `<td>${i}</td>`;
                
                for (let j = 1; j <= 10; j++) {
                    row.innerHTML += `<td>${i * j}</td>`;
                }
                
                table.appendChild(row);
            }
            
            // إضافة تأثيرات عند التمرير
            window.addEventListener('scroll', function() {
                const cards = document.querySelectorAll('.exercise-card');
                const windowHeight = window.innerHeight;
                
                cards.forEach(card => {
                    const cardPosition = card.getBoundingClientRect().top;
                    if (cardPosition < windowHeight - 100) {
                        card.style.opacity = '1';
                        card.style.transform = 'translateY(0)';
                    }
                });
            });
            
            // تهيئة البطاقات للظهور بالتتابع
            const cards = document.querySelectorAll('.exercise-card');
            cards.forEach((card, index) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                card.style.transition = `all 0.5s ease ${index * 0.1}s`;
                
                // تأخير لضمان تطبيق الأنيميشن
                setTimeout(() => {
                    const cardPosition = card.getBoundingClientRect().top;
                    const windowHeight = window.innerHeight;
                    
                    if (cardPosition < windowHeight) {
                        card.style.opacity = '1';
                        card.style.transform = 'translateY(0)';
                    }
                }, 100);
            });
        });
    </script>
</body>
</html>
